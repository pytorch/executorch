
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
  <meta name="robots" content="noindex">
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Using ExecuTorch on iOS &#8212; ExecuTorch main documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=047068a3" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=a8da1a53"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'using-executorch-ios';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://docs.pytorch.org/executorch/executorch-versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'main';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = true;
        </script>
    <link rel="canonical" href="https://docs.pytorch.org/executorch/using-executorch-ios.html" />
    <link rel="icon" href="_static/executorch-chip-logo.svg"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Backends" href="ios-backends.html" />
    <link rel="prev" title="iOS" href="ios-section.html" />

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/2.3.1/list.min.js"></script>
<script>
  if (window.location.hostname === 'docs.pytorch.org' || window.location.hostname === 'docs-preview.pytorch.org') {
    const script = document.createElement('script');
    script.src = 'https://cmp.osano.com/16A0DbT9yDNIaQkvZ/31b1b91a-e0b6-47ea-bde2-7f2bd13dbe5c/osano.js?variant=one';
    document.head.appendChild(script);
  }
</script>
<script>
  // Cookie banner for non-LF projects
  document.addEventListener('DOMContentLoaded', function () {
    // Hide cookie banner on local environments and LF owned docs
    if (window.location.hostname === 'localhost' ||
      window.location.hostname === '0.0.0.0' ||
      window.location.hostname === '127.0.0.1' ||
      window.location.hostname === 'docs.pytorch.org' ||
      window.location.hostname === 'docs-preview.pytorch.org' ||
      window.location.hostname.startsWith('192.168.')) {
      const banner = document.querySelector('.cookie-banner-wrapper');
      if (banner) {
        banner.style.display = 'none';
      }
    }
  });
</script>
<!-- Conditional CSS for header and footer height adjustment -->


<link rel="stylesheet" type="text/css" href="_static/css/theme.css" crossorigin="anonymous">
<script type="text/javascript" src="_static/js/theme.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400&display=swap" rel="stylesheet">
<meta property="og:image" content="https://docs.pytorch.org/docs/stable/_static/img/pytorch_seo.png" />
<link rel="stylesheet" href="_static/webfonts/all.min.css" crossorigin="anonymous">
<meta http-equiv="Content-Security-Policy"
  content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:; style-src * 'unsafe-inline'; script-src * 'unsafe-inline' 'unsafe-eval' blob:;">
<meta name="pytorch_project" content="">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8XT4PS" height="0" width="0"
    style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<!-- Google Tag Manager -->
<script>(function (w, d, s, l, i) {
    w[l] = w[l] || []; w[l].push({
      'gtm.start':
        new Date().getTime(), event: 'gtm.js'
    }); var f = d.getElementsByTagName(s)[0],
      j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
        'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
    j.onload = function () {
      window.dispatchEvent(new Event('gtm_loaded'));
      console.log('GTM loaded successfully');
    };
  })(window, document, 'script', 'dataLayer', 'GTM-T8XT4PS');
</script>
<!-- End Google Tag Manager -->
<!-- Facebook Pixel Code -->
<script>
  !function (f, b, e, v, n, t, s) {
    if (f.fbq) return; n = f.fbq = function () {
      n.callMethod ?
        n.callMethod.apply(n, arguments) : n.queue.push(arguments)
    };
    if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
    n.queue = []; t = b.createElement(e); t.async = !0;
    t.src = v; s = b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t, s)
  }(window, document, 'script',
    'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '243028289693773');
  fbq('track', 'PageView');
</script>
<script>
  document.documentElement.setAttribute('data-version', 'main');
</script>
<noscript>
  <img height="1" width="1" src="https://www.facebook.com/tr?id=243028289693773&ev=PageView&noscript=1" />
</noscript>
<script>
  function gtag() {
    window.dataLayer.push(arguments);
  }
</script>
<!-- End Facebook Pixel Code -->
<!-- Repository configuration for tutorials -->

<!-- Script to Fix scrolling -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    // Fix anchor scrolling
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const targetId = this.getAttribute('href').substring(1);
        const targetElement = document.getElementById(targetId);

        if (targetElement) {
          const headerHeight =
            (document.querySelector('.header-holder') ? document.querySelector('.header-holder').offsetHeight : 0) +
            (document.querySelector('.bd-header') ? document.querySelector('.bd-header').offsetHeight : 0) + 20;

          const targetPosition = targetElement.getBoundingClientRect().top + window.pageYOffset - headerHeight;
          window.scrollTo({
            top: targetPosition,
            behavior: 'smooth'
          });

          // Update URL hash without scrolling
          history.pushState(null, null, '#' + targetId);
        }
      });
    });
  });
</script>

<script async src="https://cse.google.com/cse.js?cx=e65585f8c3ea1440e"></script>

<!--
   Search engines should not index the main version of documentation.
   Stable documentation are built without release == 'main'.
   -->
<meta name="robots" content="noindex">


  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>

  </head>

<body data-feedback-url="https://github.com/pytorch/executorch" class="pytorch-body">
  
    <div class="container-fluid header-holder tutorials-header" id="header-holder">
   <div class="header-container-wrapper">
    <div class="header-container">
      <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>

          <li class="main-menu-item">
          <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
                <span>Learn</span>
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/get-started/locally">
                  <span class=dropdown-title>Get Started</span>
                </a>
                <a class="nav-dropdown-item" href="https://docs.pytorch.org/tutorials">
                  <span class="dropdown-title">Tutorials</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/beginner/basics/intro.html">
                  <span class="dropdown-title">Learn the Basics</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/recipes/recipes_index.html">
                  <span class="dropdown-title">PyTorch Recipes</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/tutorials/beginner/introyt.html">
                  <span class="dropdown-title">Intro to PyTorch - YouTube Series</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/webinars/">
                  <span class="dropdown-title">Webinars</span>
                </a>
              </div>
            </div>
          </li>

          <li class="main-menu-item">
          <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
              <span>Community</span>
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://landscape.pytorch.org/" target="_blank">
                  <span class="dropdown-title">Landscape</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/join-ecosystem">
                  <span class="dropdown-title">Join the Ecosystem</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/community-hub/">
                  <span class="dropdown-title">Community Hub</span>
                </a>
                <a class="nav-dropdown-item" href="https://discuss.pytorch.org/">
                  <span class="dropdown-title">Forums</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/resources">
                  <span class=dropdown-title>Developer Resources</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/contributor-awards/">
                  <span class="dropdown-title">Contributor Awards</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/community-events/">
                  <span class="dropdown-title">Community Events</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/programs/ambassadors/">
                  <span class="dropdown-title">PyTorch Ambassadors</span>
                </a>
              </div>
            </div>
          </li>

          <li class="main-menu-item">
          <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
              <span>Projects</span>
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/projects/pytorch/">
                  <span class="dropdown-title">PyTorch</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/projects/vllm/">
                  <span class="dropdown-title">vLLM</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/projects/deepspeed/">
                  <span class="dropdown-title">DeepSpeed</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/projects/host-your-project/">
                  <span class="dropdown-title">Host Your Project</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/projects/ray/">
                  <span class="dropdown-title">RAY</span>
                </a>
              </div>
            </div>
          </li>

          <li class="main-menu-item">
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
              <span> Docs</span>
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://docs.pytorch.org/docs/stable/index.html">
                  <span class="dropdown-title">PyTorch</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/domains">
                  <span class="dropdown-title">Domains</span>
                </a>
              </div>
            </div>
          </li>

          <li class="main-menu-item">
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
              <span>Blogs & News</span>
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/blog/">
                  <span class="dropdown-title">Blog</span>
                </a>
                 <a class="nav-dropdown-item" href="https://pytorch.org/announcements">
                  <span class="dropdown-title">Announcements</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/case-studies/">
                  <span class="dropdown-title">Case Studies</span>
                <a class="nav-dropdown-item" href="https://pytorch.org/events">
                  <span class="dropdown-title">Events</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/newsletter">
                  <span class="dropdown-title">Newsletter</span>
                </a>
            </div>
          </li>

          <li class="main-menu-item">
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
              <span>About</span>
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/foundation">
                  <span class="dropdown-title">PyTorch Foundation</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/members">
                  <span class="dropdown-title">Members</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/governing-board">
                  <span class="dropdown-title">Governing Board</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/tac">
                  <span class="dropdown-title">Technical Advisory Council</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/credits">
                  <span class="dropdown-title">Cloud Credit Program</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/staff">
                  <span class="dropdown-title">Staff</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/contact">
                  <span class="dropdown-title">Contact</span>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/wp-content/uploads/2025/09/pytorch_brand_guide_091925a.pdf">
                  <span class="dropdown-title">Brand Guidelines</span>
                </a>
              </div>
            </div>
          </li>

          <li class="main-menu-item">
            <div class="no-dropdown main-menu-button">
              <a href="https://pytorch.org/join" data-cta="join">
                JOIN
              </a>
            </div>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu">
        <i class="fa-solid fa-ellipsis"></i>
      </a>
    </div>
  </div>
 </div>

 <!-- Begin Mobile Menu -->

<div class="mobile-main-menu">
  <div class="container-fluid">
    <div class="header-container-wrapper">
      <div class="mobile-main-menu-header-container">
        <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu">
        </a>
      </div>
    </div>
  </div>

  <div class="mobile-main-menu-links-container">
    <div class="main-menu">
      <ul>
         <li class="resources-mobile-menu-title">
           <a>Learn</a>
         </li>
         <ul class="resources-mobile-menu-items">
           <li>
             <a href="https://pytorch.org/get-started/locally">Get Started</a>
           </li>
           <li>
             <a href="https://docs.pytorch.org/tutorials">Tutorials</a>
           </li>
           <li>
             <a href="https://pytorch.org/tutorials/beginner/basics/intro.html">Learn the Basics</a>
           </li>
           <li>
             <a href="https://pytorch.org/tutorials/recipes/recipes_index.html">PyTorch Recipes</a>
           </li>
           <li>
             <a href="https://pytorch.org/tutorials/beginner/introyt.html">Introduction to PyTorch - YouTube Series</a>
           </li>
           <li>
            <a href="https://pytorch.org/webinars/">Webinars</a>
          </li>
        </ul>
         <li class="resources-mobile-menu-title">
           <a>Community</a>
         </li>
         <ul class="resources-mobile-menu-items">
          <li>
            <a href="https://landscape.pytorch.org/">Landscape</a>
          </li>
          <li>
             <a href="https://pytorch.org/join-ecosystem">Join the Ecosystem</a>
           </li>
           <li>
             <a href="https://pytorch.org/community-hub/">Community Hub</a>
           </li>
           <li>
             <a href="https://discuss.pytorch.org/">Forums</a>
           </li>
           <li>
             <a href="https://pytorch.org/resources">Developer Resources</a>
           </li>
           <li>
             <a href="https://pytorch.org/contributor-awards/">Contributor Awards</a>
           </li>
           <li>
            <a href="https://pytorch.org/community-events/">Community Events</a>
          </li>
          <li>
            <a href="https://pytorch.org/programs/ambassadors/">PyTorch Ambassadors</a>
          </li>
       </ul>

         <li class="resources-mobile-menu-title">
           <a>Projects</a>
         </li>

         <ul class="resources-mobile-menu-items">
           <li>
             <a href="https://pytorch.org/projects/pytorch/">PyTorch</a>
           </li>

           <li>
             <a href="https://pytorch.org/projects/vllm/">vLLM</a>
           </li>
           <li>
            <a href="https://pytorch.org/projects/deepspeed/">DeepSpeed</a>
          </li>
          <li>
             <a href="https://pytorch.org/projects/host-your-project/">Host Your Project</a>
           </li>
         </ul>

         <li class="resources-mobile-menu-title">
           <a>Docs</a>
         </li>

         <ul class="resources-mobile-menu-items">
          <li>
            <a href="https://docs.pytorch.org/docs/stable/index.html">PyTorch</a>
          </li>

          <li>
            <a href="https://pytorch.org/domains">Domains</a>
          </li>
        </ul>

        <li class="resources-mobile-menu-title">
          <a>Blog & News</a>
        </li>

         <ul class="resources-mobile-menu-items">
          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>
          <li>
            <a href="https://pytorch.org/announcements">Announcements</a>
          </li>

          <li>
            <a href="https://pytorch.org/case-studies/">Case Studies</a>
          </li>
          <li>
            <a href="https://pytorch.org/events">Events</a>
          </li>
          <li>
             <a href="https://pytorch.org/newsletter">Newsletter</a>
           </li>
        </ul>

        <li class="resources-mobile-menu-title">
          <a>About</a>
        </li>

        <ul class="resources-mobile-menu-items">
          <li>
            <a href="https://pytorch.org/foundation">PyTorch Foundation</a>
          </li>
          <li>
            <a href="https://pytorch.org/members">Members</a>
          </li>
          <li>
            <a href="https://pytorch.org/governing-board">Governing Board</a>
          </li>
          <li>
            <a href="https://pytorch.org/tac">Technical Advisory Council</a>
         </li>
         <li>
             <a href="https://pytorch.org/credits">Cloud Credit Program</a>
          </li>
          <li>
             <a href="https://pytorch.org/staff">Staff</a>
          </li>
          <li>
             <a href="https://pytorch.org/contact">Contact</a>
          </li>
        </ul>
      </ul>
    </div>
  </div>
</div>

<!-- End Mobile Menu -->
  
  
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/et-logo.png" class="logo__image only-light" alt="ExecuTorch main documentation - Home"/>
    <script>document.write(`<img src="_static/et-logo.png" class="logo__image only-dark" alt="ExecuTorch main documentation - Home"/>`);</script>
  
  
</a></div>
    
      <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="intro-section.html">
    Intro
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="quick-start-section.html">
    Quick Start
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="edge-platforms-section.html">
    Edge
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="backends-section.html">
    Backends
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="llm/working-with-llms.html">
    LLMs
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="advanced-topics-section.html">
    Advanced
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="tools-section.html">
    Tools
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="api-section.html">
    API
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="support-section.html">
    Support
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">
  
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
</div>
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://x.com/PyTorch" title="X" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-x-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">X</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pytorch/executorch" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discuss.pytorch.org/" title="Discourse" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discourse fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discourse</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/executorch" title="PyPi" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPi</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="intro-section.html">
    Intro
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="quick-start-section.html">
    Quick Start
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="edge-platforms-section.html">
    Edge
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="backends-section.html">
    Backends
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="llm/working-with-llms.html">
    LLMs
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="advanced-topics-section.html">
    Advanced
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="tools-section.html">
    Tools
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="api-section.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="support-section.html">
    Support
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
  
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
</div>
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://x.com/PyTorch" title="X" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-x-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">X</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pytorch/executorch" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discuss.pytorch.org/" title="Discourse" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discourse fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discourse</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/executorch" title="PyPi" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-python fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPi</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"></div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="edge-platforms-section.html" class="nav-link">Edge</a></li>
    
    
    <li class="breadcrumb-item"><a href="ios-section.html" class="nav-link">iOS</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Using...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">
<div class="rating">
    Rate this Page
    <div class="stars">
        
        <span class="star" data-behavior="tutorial-rating" data-count="1" data-value="1">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="2" data-value="2">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="3" data-value="3">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="4" data-value="4">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="5" data-value="5">★</span>
        
    </div>
</div>
</div>
      
    </div>
  
</div>
</div>
              
              
  
<div id="searchbox"></div>
  <article class="bd-article" id="pytorch-article">
    <!-- Hidden breadcrumb schema for SEO only -->
    <div style="display:none;" itemscope itemtype="https://schema.org/BreadcrumbList">
      
      <div itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <link itemprop="item" href="edge-platforms-section.html">
        <meta itemprop="name" content="Edge">
        <meta itemprop="position" content="1">
      </div>
      
      <div itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <link itemprop="item" href="ios-section.html">
        <meta itemprop="name" content="iOS">
        <meta itemprop="position" content="2">
      </div>
      
      <div itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <meta itemprop="name" content="Using ExecuTorch on iOS">
        <meta itemprop="position" content="3">
      </div>
    </div>

    
    

    
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="using-executorch-on-ios">
<h1>Using ExecuTorch on iOS<a class="headerlink" href="#using-executorch-on-ios" title="Link to this heading">#</a></h1>
<p>ExecuTorch supports both iOS and macOS via Objective-C, Swift, and C++. ExecuTorch also provides backends to leverage Core ML and Metal Performance Shaders (MPS) for hardware-accelerated execution on Apple platforms.</p>
<section id="integration">
<h2>Integration<a class="headerlink" href="#integration" title="Link to this heading">#</a></h2>
<p>The ExecuTorch Runtime for iOS and macOS (ARM64) is distributed as a collection of prebuilt <a class="reference external" href="https://developer.apple.com/documentation/xcode/creating-a-multi-platform-binary-framework-bundle">.xcframework</a> binary targets. These targets are compatible with both iOS and macOS devices and simulators and are available in both release and debug modes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">executorch</span></code> - Core runtime components</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">executorch_llm</span></code> - LLM-specific runtime components</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">backend_coreml</span></code> - Core ML backend</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">backend_mps</span></code> - MPS backend</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">backend_xnnpack</span></code> - XNNPACK backend</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kernels_llm</span></code> - Custom kernels for LLMs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kernels_optimized</span></code> - Accelerated generic CPU kernels</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kernels_quantized</span></code> - Quantized kernels</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kernels_torchao</span></code> - Quantized CPU kernels from torchao</p></li>
</ul>
<p>Link your binary with the ExecuTorch runtime and any backends or kernels used by the exported ML model. It is recommended to link the core runtime to the components that use ExecuTorch directly, and link kernels and backends against the main app target.</p>
<p><strong>Note:</strong> You may need to add some extra linker flags for the build settings of the components that links against ExecuTorch backends or kernels to let them register properly at the app startup. See the <a class="reference internal" href="#Linkage"><span class="xref myst">Linkage</span></a> section for more details.</p>
<p><strong>Note:</strong> To access logs, link against the Debug build of the ExecuTorch runtime, i.e., the <code class="docutils literal notranslate"><span class="pre">executorch_debug</span></code> framework. For optimal performance, always link against the Release version of the deliverables (those without the <code class="docutils literal notranslate"><span class="pre">_debug</span></code> suffix), which have all logging overhead removed. See the <a class="reference internal" href="#Logging"><span class="xref myst">Logging</span></a> section for more details.</p>
<section id="swift-package-manager">
<h3>Swift Package Manager<a class="headerlink" href="#swift-package-manager" title="Link to this heading">#</a></h3>
<p>The prebuilt ExecuTorch runtime, backend, and kernels are available as a <a class="reference external" href="https://www.swift.org/documentation/package-manager/">Swift PM</a> package.</p>
<section id="xcode">
<h4>Xcode<a class="headerlink" href="#xcode" title="Link to this heading">#</a></h4>
<p>In Xcode, go to <code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">&gt;</span> <span class="pre">Add</span> <span class="pre">Package</span> <span class="pre">Dependencies</span></code>. Paste the URL of the <a class="reference external" href="https://github.com/pytorch/executorch">ExecuTorch repo</a> into the search bar and select it. Make sure to change the branch name to the desired ExecuTorch version in format “swiftpm-<version>”, (e.g. “swiftpm-1.0.0”), or a branch name in format “swiftpm-<version>.&lt;year_month_date&gt;” (e.g. “swiftpm-1.1.0-20251101”) for a <a class="reference external" href="https://ossci-ios.s3.amazonaws.com/list.html">nightly build</a> on a specific date.</p>
<p><img alt="" src="_images/swiftpm_xcode1.png" /></p>
<p>Then select which ExecuTorch framework should link against which target.</p>
<p><img alt="" src="_images/swiftpm_xcode2.png" /></p>
<p>Click the screenshot below to watch the <em>demo video</em> on how to add the package and run a simple ExecuTorch model on iOS.</p>
<a href="_static/img/swiftpm_xcode.mp4">
  <img src="_static/img/swiftpm_xcode.png" width="800" alt="Integrating and Running ExecuTorch on Apple Platforms">
</a>
</section>
<section id="cli">
<h4>CLI<a class="headerlink" href="#cli" title="Link to this heading">#</a></h4>
<p>Add a package and target dependencies on ExecuTorch to your package file like this:</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="c1">// swift-tools-version:5.9</span>
<span class="kd">import</span><span class="w"> </span><span class="nc">PackageDescription</span>

<span class="kd">let</span><span class="w"> </span><span class="nv">package</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Package</span><span class="p">(</span>
<span class="w">  </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;YourPackageName&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="n">platforms</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">.</span><span class="n">iOS</span><span class="p">(.</span><span class="n">v17</span><span class="p">),</span>
<span class="w">    </span><span class="p">.</span><span class="n">macOS</span><span class="p">(.</span><span class="n">v12</span><span class="p">),</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="n">products</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">.</span><span class="n">library</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;YourPackageName&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">targets</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;YourTargetName&quot;</span><span class="p">]),</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="n">dependencies</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="c1">// Use &quot;swiftpm-&lt;version&gt;.&lt;year_month_day&gt;&quot; branch name for a nightly build.</span>
<span class="w">    </span><span class="p">.</span><span class="n">package</span><span class="p">(</span><span class="n">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://github.com/pytorch/executorch.git&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">branch</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;swiftpm-1.0.0&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="n">targets</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">.</span><span class="n">target</span><span class="p">(</span>
<span class="w">      </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;YourTargetName&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="n">dependencies</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">.</span><span class="n">product</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;executorch&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">package</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;executorch&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">product</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;backend_xnnpack&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">package</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;executorch&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">product</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;kernels_optimized&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">package</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;executorch&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="c1">// Add other backends and kernels as needed.</span>
<span class="w">      </span><span class="p">]),</span>
<span class="w">      </span><span class="n">linkerSettings</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">         </span><span class="c1">// Force load all symbols from static libraries to trigger backends and kernels registration</span>
<span class="w">         </span><span class="p">.</span><span class="n">unsafeFlags</span><span class="p">([</span><span class="s">&quot;-Wl,-all_load&quot;</span><span class="p">])</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Then check if everything works correctly:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>path/to/your/package

swift<span class="w"> </span>package<span class="w"> </span>resolve

<span class="c1"># or just build it</span>
swift<span class="w"> </span>build
</pre></div>
</div>
</section>
</section>
<section id="building-from-source">
<h3>Building from Source<a class="headerlink" href="#building-from-source" title="Link to this heading">#</a></h3>
<p>Another way to integrate the ExecuTorch runtime is to build the necessary components from sources locally and link against them. This is useful when customizing the runtime.</p>
<ol class="arabic simple">
<li><p>Install <a class="reference external" href="https://developer.apple.com/xcode/resources/">Xcode</a> 15+ and Command Line Tools:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xcode-select<span class="w"> </span>--install
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Clone ExecuTorch:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>viable/strict<span class="w"> </span>https://github.com/pytorch/executorch.git<span class="w"> </span>--depth<span class="w"> </span><span class="m">1</span><span class="w"> </span>--recurse-submodules<span class="w"> </span>--shallow-submodules<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>executorch
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Set up <a class="reference external" href="https://www.python.org/downloads/macos/">Python</a> 3.10+ and activate a virtual environment:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>.venv<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">source</span><span class="w"> </span>.venv/bin/activate<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Install the required dependencies, including those needed for the backends like <a class="reference internal" href="backends/coreml/coreml-overview.html"><span class="std std-doc">Core ML</span></a> or <a class="reference internal" href="backends/mps/mps-overview.html"><span class="std std-doc">MPS</span></a>, if you plan to build them later:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./install_requirements.sh

<span class="c1"># CoreML-only requirements:</span>
./backends/apple/coreml/scripts/install_requirements.sh
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Install <a class="reference external" href="https://cmake.org">CMake</a>:</p></li>
</ol>
<p>Download the macOS binary distribution from the <a class="reference external" href="https://cmake.org/download">CMake website</a>, open the <code class="docutils literal notranslate"><span class="pre">.dmg</span></code> file, move <code class="docutils literal notranslate"><span class="pre">CMake.app</span></code> to the <code class="docutils literal notranslate"><span class="pre">/Applications</span></code> directory, and then run the following command to install the CMake command-line tools:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>/Applications/CMake.app/Contents/bin/cmake-gui<span class="w"> </span>--install
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>Use the provided script to build .xcframeworks:</p></li>
</ol>
<p>The following command will build the ExecuTorch runtime components along with all available kernels and backends for the Apple platform in both Release and Debug modes:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./scripts/build_apple_frameworks.sh
</pre></div>
</div>
<p>After the build finishes successfully, the resulting frameworks can be found in the <code class="docutils literal notranslate"><span class="pre">cmake-out</span></code> directory.
Copy them to your project and link them against your targets.</p>
</section>
</section>
<section id="linkage">
<h2>Linkage<a class="headerlink" href="#linkage" title="Link to this heading">#</a></h2>
<p>ExecuTorch initializes its backends and kernels (operators) during app startup by registering them in a static dictionary. If you encounter errors like “unregistered kernel” or “unregistered backend” at runtime, you may need to explicitly force-load certain components. Use the <code class="docutils literal notranslate"><span class="pre">-all_load</span></code> or <code class="docutils literal notranslate"><span class="pre">-force_load</span></code> linker flags in your Xcode build configuration to ensure components are registered early.</p>
<p>Here’s an example of a Xcode configuration file (<code class="docutils literal notranslate"><span class="pre">.xcconfig</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ET_PLATFORM[sdk=iphonesimulator*] = simulator
ET_PLATFORM[sdk=iphoneos*] = ios
ET_PLATFORM[sdk=macos*] = macos

OTHER_LDFLAGS = $(inherited) \
    -force_load $(BUILT_PRODUCTS_DIR)/libexecutorch_debug_$(ET_PLATFORM).a \
    -force_load $(BUILT_PRODUCTS_DIR)/libbackend_coreml_$(ET_PLATFORM).a \
    -force_load $(BUILT_PRODUCTS_DIR)/libbackend_mps_$(ET_PLATFORM).a \
    -force_load $(BUILT_PRODUCTS_DIR)/libbackend_xnnpack_$(ET_PLATFORM).a \
    -force_load $(BUILT_PRODUCTS_DIR)/libkernels_optimized_$(ET_PLATFORM).a \
    -force_load $(BUILT_PRODUCTS_DIR)/libkernels_quantized_$(ET_PLATFORM).a
</pre></div>
</div>
<p><strong>Note:</strong> In the example above, we link against the Debug version of the ExecuTorch runtime (<code class="docutils literal notranslate"><span class="pre">libexecutorch_debug</span></code>) to preserve the logs. Normally, that does not impact the performance too much. Nevertheless, remember to link against the release version of the runtime (<code class="docutils literal notranslate"><span class="pre">libexecutorch</span></code>) for the best performance and no logs.</p>
<p>You can assign such a config file to your target in Xcode:</p>
<ol class="arabic simple">
<li><p>Add the <code class="docutils literal notranslate"><span class="pre">.xcconfig</span></code> file to your project.</p></li>
<li><p>Navigate to the project’s Info tab.</p></li>
<li><p>Select the configuration file in the build configurations for Release (or Debug) mode.</p></li>
</ol>
</section>
<section id="runtime-api">
<h2>Runtime API<a class="headerlink" href="#runtime-api" title="Link to this heading">#</a></h2>
<p>ExecuTorch provides native Objective-C APIs, automatically bridged to Swift, for interacting with the runtime. These APIs act as wrappers around the core C++ components found in <a class="reference internal" href="extension-tensor.html"><span class="std std-doc">extension/tensor</span></a> and <a class="reference internal" href="extension-module.html"><span class="std std-doc">extension/module</span></a>, offering a more idiomatic experience for Apple platform developers.</p>
<p><strong>Note:</strong> These Objective-C/Swift APIs are currently experimental and subject to change.</p>
<section id="importing">
<h3>Importing<a class="headerlink" href="#importing" title="Link to this heading">#</a></h3>
<p>Once linked against the <code class="docutils literal notranslate"><span class="pre">executorch</span></code> framework, you can import the necessary components.</p>
<p>Objective-C (Objective-C++):</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="c1">// Import the main umbrella header for Module/Tensor/Value wrappers.</span>
<span class="cp">#import &lt;ExecuTorch/ExecuTorch.h&gt;</span>

<span class="c1">// If using C++ directly alongside Objective-C++, you might still need C++ headers.</span>
<span class="cp">#import &lt;executorch/extension/module/module.h&gt;</span>
<span class="cp">#import &lt;executorch/extension/tensor/tensor.h&gt;</span>
</pre></div>
</div>
<p>Swift:</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="kd">import</span><span class="w"> </span><span class="nc">ExecuTorch</span>
</pre></div>
</div>
<section id="example">
<h4>Example<a class="headerlink" href="#example" title="Link to this heading">#</a></h4>
<p>Here’s a concise example demonstrating how to load a model, prepare input, run inference, and process output using the Objective-C and Swift API. Imagine you have a MobileNet v3 model (<code class="docutils literal notranslate"><span class="pre">mv3.pte</span></code>) that takes a <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">3,</span> <span class="pre">224,</span> <span class="pre">224]</span></code> float tensor as input and outputs logits.</p>
<p>Objective-C:</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">modelPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSBundle</span><span class="w"> </span><span class="n">mainBundle</span><span class="p">]</span><span class="w"> </span><span class="n">pathForResource</span><span class="o">:</span><span class="s">@&quot;mv3&quot;</span><span class="w"> </span><span class="n">ofType</span><span class="o">:</span><span class="s">@&quot;pte&quot;</span><span class="p">];</span>

<span class="c1">// Create a module with the model file path. Nothing gets loaded into memory just yet.</span>
<span class="n">ExecuTorchModule</span><span class="w"> </span><span class="o">*</span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">ExecuTorchModule</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithFilePath</span><span class="o">:</span><span class="n">modelPath</span><span class="p">];</span>

<span class="bp">NSError</span><span class="w"> </span><span class="o">*</span><span class="n">error</span><span class="p">;</span><span class="w">  </span><span class="c1">// Optional error output argument to learn about failures.</span>

<span class="c1">// Force-load the program and &#39;forward&#39; method. Otherwise, it&#39;s loaded at the first execution.</span>
<span class="p">[</span><span class="n">module</span><span class="w"> </span><span class="n">loadMethod</span><span class="o">:</span><span class="s">@&quot;forward&quot;</span><span class="w"> </span><span class="n">error</span><span class="o">:&amp;</span><span class="n">error</span><span class="p">];</span>

<span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">imageBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...;</span><span class="w">  </span><span class="c1">// Existing image buffer.</span>

<span class="c1">// Create an input tensor referencing the buffer and assuming the given shape and data type.</span>
<span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="o">*</span><span class="n">inputTensor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithBytesNoCopy</span><span class="o">:</span><span class="n">imageBuffer</span>
<span class="w">                                                                        </span><span class="nl">shape</span><span class="p">:</span><span class="l">@[</span><span class="mi">@1</span><span class="p">,</span><span class="w"> </span><span class="mi">@3</span><span class="p">,</span><span class="w"> </span><span class="mi">@224</span><span class="p">,</span><span class="w"> </span><span class="mi">@224</span><span class="l">]</span>
<span class="w">                                                                     </span><span class="nl">dataType</span><span class="p">:</span><span class="n">ExecuTorchDataTypeFloat</span><span class="p">];</span>

<span class="c1">// Execute the &#39;forward&#39; method with the given input tensor and get output values back.</span>
<span class="bp">NSArray</span><span class="o">&lt;</span><span class="n">ExecuTorchValue</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">module</span><span class="w"> </span><span class="n">forwardWithTensor</span><span class="o">:</span><span class="n">inputTensor</span><span class="w"> </span><span class="n">error</span><span class="o">:&amp;</span><span class="n">error</span><span class="p">];</span>

<span class="c1">// Get the first output value assuming it&#39;s a tensor.</span>
<span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="o">*</span><span class="n">outputTensor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">outputs</span><span class="p">.</span><span class="n">firstObject</span><span class="p">.</span><span class="n">tensorValue</span><span class="p">;</span>

<span class="c1">// Access the output tensor data.</span>
<span class="p">[</span><span class="n">outputTensor</span><span class="w"> </span><span class="n">bytesWithHandler</span><span class="o">:^</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pointer</span><span class="p">,</span><span class="w"> </span><span class="n">NSInteger</span><span class="w"> </span><span class="n">count</span><span class="p">,</span><span class="w"> </span><span class="n">ExecuTorchDataType</span><span class="w"> </span><span class="n">dataType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">logits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">pointer</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// Use logits...</span>
<span class="p">}];</span>
</pre></div>
</div>
<p>Swift:</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nv">modelPath</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Bundle</span><span class="p">.</span><span class="n">main</span><span class="p">.</span><span class="n">path</span><span class="p">(</span><span class="n">forResource</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mv3&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ofType</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;pte&quot;</span><span class="p">)</span><span class="o">!</span>

<span class="c1">// Create a module with the model file path. Nothing gets loaded into memory just yet.</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">module</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Module</span><span class="p">(</span><span class="n">filePath</span><span class="p">:</span><span class="w"> </span><span class="n">modelPath</span><span class="p">)</span>

<span class="c1">// Force-load the program and &#39;forward&#39; method. Otherwise, it&#39;s loaded at the first execution.</span>
<span class="k">try</span><span class="w"> </span><span class="n">module</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;forward&quot;</span><span class="p">)</span>

<span class="kd">let</span><span class="w"> </span><span class="nv">imageBuffer</span><span class="p">:</span><span class="w"> </span><span class="n">UnsafeMutableRawPointer</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="c1">// Existing image buffer</span>

<span class="c1">// Create an input tensor referencing the buffer and assuming the given shape and data type.</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">inputTensor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Tensor</span><span class="p">&lt;</span><span class="nb">Float</span><span class="p">&gt;(&amp;</span><span class="n">imageBuffer</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">224</span><span class="p">,</span><span class="w"> </span><span class="mi">224</span><span class="p">])</span>

<span class="c1">// Execute the &#39;forward&#39; method with the given input tensor and get an output tensor back.</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">outputTensor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">Tensor</span><span class="p">&lt;</span><span class="nb">Float</span><span class="p">&gt;(</span><span class="n">module</span><span class="p">.</span><span class="n">forward</span><span class="p">(</span><span class="n">inputTensor</span><span class="p">))</span>

<span class="c1">// Copy the tensor data into logits array for easier access.</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">logits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">outputTensor</span><span class="p">.</span><span class="n">scalars</span><span class="p">()</span>

<span class="c1">// Use logits...</span>
</pre></div>
</div>
</section>
</section>
<section id="tensor">
<h3>Tensor<a class="headerlink" href="#tensor" title="Link to this heading">#</a></h3>
<p>A tensor is a multi-dimensional array of elements (such as floats or integers) and includes metadata like shape (dimensions) and data type. Tensors are used to feed inputs to a model and retrieve outputs, or for any computation you need to do on raw data. You can create tensors from simple arrays of numbers, inspect their properties, read or modify their contents, and even reshape or copy them.</p>
<p>ExecuTorch offers <code class="docutils literal notranslate"><span class="pre">ExecuTorchTensor</span></code> class in Objective-C and two tensor types in Swift:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">AnyTensor</span></code>: A type-erased tensor, bridged from <code class="docutils literal notranslate"><span class="pre">ExecuTorchTensor</span></code> in Objective-C. You might use it when the tensor’s data type is only known at runtime, for example, when converting from an untyped <code class="docutils literal notranslate"><span class="pre">Value</span></code> object before casting it to a generic <code class="docutils literal notranslate"><span class="pre">Tensor&lt;T&gt;</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Tensor&lt;T:</span> <span class="pre">Scalar&gt;</span></code>: A generic, type-safe wrapper around AnyTensor. This is the recommended type for most use cases in Swift. It ensures the element type (e.g., <code class="docutils literal notranslate"><span class="pre">Float</span></code>, <code class="docutils literal notranslate"><span class="pre">Int</span></code>) is known at compile time, providing type-safe access to tensor data and catching type mismatches early.</p></li>
</ul>
<p>You can convert between them using <code class="docutils literal notranslate"><span class="pre">tensor.anyTensor</span></code> (to get the underlying <code class="docutils literal notranslate"><span class="pre">AnyTensor</span></code>) and <code class="docutils literal notranslate"><span class="pre">anyTensor.asTensor()</span></code> (to convert to a typed <code class="docutils literal notranslate"><span class="pre">Tensor&lt;T&gt;</span></code> if the data types match).</p>
<section id="key-properties">
<h4>Key Properties:<a class="headerlink" href="#key-properties" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dataType</span></code>: The element type (e.g., <code class="docutils literal notranslate"><span class="pre">.float</span></code>, <code class="docutils literal notranslate"><span class="pre">.int</span></code>, <code class="docutils literal notranslate"><span class="pre">.byte</span></code>). In <code class="docutils literal notranslate"><span class="pre">Tensor&lt;T&gt;</span></code>, this is determined by <code class="docutils literal notranslate"><span class="pre">T</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shape</span></code>: An array of <code class="docutils literal notranslate"><span class="pre">Int</span></code> describing the size of each dimension.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">count</span></code>: The total number of elements.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">strides</span></code>: The jump in memory needed to advance one element along each dimension.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dimensionOrder</span></code>: The order of dimensions in memory.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shapeDynamism</span></code>: Indicates if the tensor shape can change (<code class="docutils literal notranslate"><span class="pre">.static</span></code>, <code class="docutils literal notranslate"><span class="pre">.dynamicBound</span></code>, <code class="docutils literal notranslate"><span class="pre">.dynamicUnbound</span></code>).</p></li>
</ul>
</section>
<section id="initialization">
<h4>Initialization:<a class="headerlink" href="#initialization" title="Link to this heading">#</a></h4>
<p>You can create a new tensor from an existing one, either as a view (which shares the same underlying data) or as a copy (which gets its own unique data).</p>
<ul class="simple">
<li><p>View: <code class="docutils literal notranslate"><span class="pre">init(_:)</span></code> creates a new tensor instance that points to the same memory as the original. Modifying the data through one tensor will affect the other.</p></li>
<li><p>Copy: <code class="docutils literal notranslate"><span class="pre">copy()</span></code> creates a completely independent duplicate of the tensor, including its own copy of the data.</p></li>
</ul>
<p>Objective-C:</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create a view.</span>
<span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="o">*</span><span class="n">tensorView</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithTensor</span><span class="o">:</span><span class="n">originalTensor</span><span class="p">];</span>

<span class="c1">// Create a copy.</span>
<span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="o">*</span><span class="n">tensorCopy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">originalTensor</span><span class="w"> </span><span class="k">copy</span><span class="p">];</span>
</pre></div>
</div>
<p>Swift:</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create a view.</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">tensorView</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Tensor</span><span class="p">(</span><span class="n">originalTensor</span><span class="p">)</span>

<span class="c1">// Create a copy.</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">tensorCopy</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">originalTensor</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<p>Tensors can be initialized directly from memory pointers or <code class="docutils literal notranslate"><span class="pre">Data</span></code> objects.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">init(bytesNoCopy:...)</span></code>: Creates a tensor that references an existing memory buffer without copying. The buffer’s lifetime must be managed manually and must exceed the tensor’s.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">init(bytes:...)</span></code>: Creates a tensor by copying data from a memory buffer.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">init(data:...)</span></code>: Creates a tensor using an <code class="docutils literal notranslate"><span class="pre">NSData</span></code> (Objective-C) or <code class="docutils literal notranslate"><span class="pre">Data</span></code> (Swift) object, referencing its bytes without copying.</p></li>
</ul>
<p>Objective-C:</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create by copying bytes.</span>
<span class="kt">float</span><span class="w"> </span><span class="n">data</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">1.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">4.0f</span><span class="p">};</span>
<span class="bp">NSArray</span><span class="o">&lt;</span><span class="bp">NSNumber</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="l">@[</span><span class="mi">@2</span><span class="p">,</span><span class="w"> </span><span class="mi">@2</span><span class="l">]</span><span class="p">;</span>
<span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="o">*</span><span class="n">tensorFromBytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithBytes</span><span class="o">:</span><span class="n">data</span>
<span class="w">                                                                      </span><span class="nl">shape</span><span class="p">:</span><span class="n">shape</span>
<span class="w">                                                                   </span><span class="nl">dataType</span><span class="p">:</span><span class="n">ExecuTorchDataTypeFloat</span><span class="p">];</span>

<span class="c1">// Create from NSData (no copy).</span>
<span class="bp">NSData</span><span class="w"> </span><span class="o">*</span><span class="n">nsData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSData</span><span class="w"> </span><span class="n">dataWithBytes</span><span class="o">:</span><span class="n">data</span><span class="w"> </span><span class="n">length</span><span class="o">:</span><span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">)];</span>
<span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="o">*</span><span class="n">tensorFromNSData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithData</span><span class="o">:</span><span class="n">nsData</span>
<span class="w">                                                                      </span><span class="nl">shape</span><span class="p">:</span><span class="n">shape</span>
<span class="w">                                                                   </span><span class="nl">dataType</span><span class="p">:</span><span class="n">ExecuTorchDataTypeFloat</span><span class="p">];</span>
</pre></div>
</div>
<p>Swift:</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create from a buffer without copying (unsafe).</span>
<span class="kd">var</span><span class="w"> </span><span class="nv">mutableData</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="nb">Float</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0</span><span class="p">,</span><span class="w"> </span><span class="mf">4.0</span><span class="p">]</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">tensorNoCopy</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">mutableData</span><span class="p">.</span><span class="n">withUnsafeMutableBytes</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="k">in</span>
<span class="w">  </span><span class="n">Tensor</span><span class="p">&lt;</span><span class="nb">Float</span><span class="p">&gt;(</span>
<span class="w">    </span><span class="n">bytesNoCopy</span><span class="p">:</span><span class="w"> </span><span class="n">pointer</span><span class="p">.</span><span class="n">baseAddress</span><span class="p">!,</span>
<span class="w">    </span><span class="n">shape</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// Create from Data (no copy).</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">data</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Data</span><span class="p">(</span><span class="n">bytes</span><span class="p">:</span><span class="w"> </span><span class="p">&amp;</span><span class="n">mutableData</span><span class="p">,</span><span class="w"> </span><span class="bp">count</span><span class="p">:</span><span class="w"> </span><span class="n">mutableData</span><span class="p">.</span><span class="bp">count</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">MemoryLayout</span><span class="p">&lt;</span><span class="nb">Float</span><span class="p">&gt;.</span><span class="n">size</span><span class="p">)</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">tensorFromData</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Tensor</span><span class="p">&lt;</span><span class="nb">Float</span><span class="p">&gt;(</span><span class="n">data</span><span class="p">:</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>The most convenient way to create tensors is from Swift arrays or single scalar values. The <code class="docutils literal notranslate"><span class="pre">Tensor&lt;T&gt;</span></code> API uses type inference to determine the <code class="docutils literal notranslate"><span class="pre">dataType</span></code> automatically.</p>
<p>objective-c:</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create from an array of scalars.</span>
<span class="bp">NSArray</span><span class="o">&lt;</span><span class="bp">NSNumber</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="n">scalars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="l">@[@(</span><span class="mi">1</span><span class="l">)</span><span class="p">,</span><span class="w"> </span><span class="l">@(</span><span class="mi">2</span><span class="l">)</span><span class="p">,</span><span class="w"> </span><span class="l">@(</span><span class="mi">3</span><span class="l">)]</span><span class="p">;</span>
<span class="bp">NSArray</span><span class="o">&lt;</span><span class="bp">NSNumber</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="l">@[</span><span class="mi">@3</span><span class="l">]</span><span class="p">;</span>
<span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="o">*</span><span class="n">tensorFromScalars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithScalars</span><span class="o">:</span><span class="n">scalars</span>
<span class="w">                                                                          </span><span class="nl">shape</span><span class="p">:</span><span class="n">shape</span>
<span class="w">                                                                       </span><span class="nl">dataType</span><span class="p">:</span><span class="n">ExecuTorchDataTypeInt</span><span class="p">];</span>

<span class="c1">// Create a float scalar tensor.</span>
<span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="o">*</span><span class="n">scalarTensor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithFloat</span><span class="o">:</span><span class="mf">3.14f</span><span class="p">];</span>
</pre></div>
</div>
<p>Swift:</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create from an array of scalars (infers shape and copies data).</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">tensor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0</span><span class="p">,</span><span class="w"> </span><span class="mf">4.0</span><span class="p">])</span><span class="w"> </span><span class="c1">// Creates a Tensor&lt;Double&gt; with shape [4]</span>

<span class="c1">// Specify shape.</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">tensorWithShape</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">],</span><span class="w"> </span><span class="n">shape</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">])</span><span class="w"> </span><span class="c1">// Creates Tensor&lt;Int&gt;</span>

<span class="c1">// Create without copying from an `inout` array.</span>
<span class="kd">var</span><span class="w"> </span><span class="nv">liveData</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="nb">Int32</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">]</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">tensorNoCopy</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Tensor</span><span class="p">(&amp;</span><span class="n">liveData</span><span class="p">)</span><span class="w"> </span><span class="c1">// Modifying `liveData` affects `tensorNoCopy`</span>

<span class="c1">// Create an Int scalar tensor.</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">scalarTensor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Tensor</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span><span class="w"> </span><span class="c1">// Infers Tensor&lt;Int&gt; with shape []</span>
</pre></div>
</div>
</section>
<section id="factory-methods">
<h4>Factory Methods:<a class="headerlink" href="#factory-methods" title="Link to this heading">#</a></h4>
<p>ExecuTorch provides a rich set of factory methods to create tensors with pre-filled or random data.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">empty</span></code>: Creates a tensor with uninitialized data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">full</span></code>: Creates a tensor filled with a specified scalar value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ones</span></code>: Creates a tensor filled with ones.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zeros</span></code>: Creates a tensor filled with zeros.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rand</span></code>: Creates a tensor with random values uniformly distributed in <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1)</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">randn</span></code>: Creates a tensor with random values from a normal distribution (mean 0, variance 1).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">randint</span></code>: Creates a tensor with random integers in a specified range <code class="docutils literal notranslate"><span class="pre">[low,</span> <span class="pre">high)</span></code>.</p></li>
</ul>
<p>Each method has a <code class="docutils literal notranslate"><span class="pre">like:</span></code> variant that creates a new tensor with the same shape and properties as an existing one.</p>
<p>Objective-C:</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create a 2x2 tensor filled with zeros.</span>
<span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="o">*</span><span class="n">zeros</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="n">zerosTensorWithShape</span><span class="o">:</span><span class="l">@[</span><span class="mi">@2</span><span class="p">,</span><span class="w"> </span><span class="mi">@2</span><span class="l">]</span>
<span class="w">                                                        </span><span class="nl">dataType</span><span class="p">:</span><span class="n">ExecuTorchDataTypeFloat</span><span class="p">];</span>

<span class="c1">// Create a tensor of ones with the same shape as `zeros`.</span>
<span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="o">*</span><span class="n">ones</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="n">onesTensorLikeTensor</span><span class="o">:</span><span class="n">zeros</span><span class="p">];</span>
</pre></div>
</div>
<p>Swift:</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create a 2x2 tensor filled with the value 7.</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">fullTensor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Tensor</span><span class="p">&lt;</span><span class="nb">Int32</span><span class="p">&gt;.</span><span class="n">full</span><span class="p">(</span><span class="n">shape</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">scalar</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span>

<span class="c1">// Create a 3x3 tensor of ones.</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">onesTensor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Tensor</span><span class="p">&lt;</span><span class="nb">Float</span><span class="p">&gt;.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">])</span>

<span class="c1">// Create a tensor of zeros with the same shape as onesTensor.</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">zerosTensor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Tensor</span><span class="p">&lt;</span><span class="nb">Float</span><span class="p">&gt;.</span><span class="n">zeros</span><span class="p">(</span><span class="n">like</span><span class="p">:</span><span class="w"> </span><span class="n">onesTensor</span><span class="p">)</span>

<span class="c1">// Create a tensor with random integers between 10 (inclusive) and 20 (exclusive).</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">randomInts</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Tensor</span><span class="p">&lt;</span><span class="nb">Int</span><span class="p">&gt;.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>

<span class="c1">// Create a 2x2 type-erased tensor filled with zeros and explicit data type.</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">anyZeros</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">AnyTensor</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">dataType</span><span class="p">:</span><span class="w"> </span><span class="p">.</span><span class="n">float</span><span class="p">)</span>

<span class="c1">// Create a 2x3 type-erased tensor filled with random values and explicit data type.</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">anyRand</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">AnyTensor</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="n">shape</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="n">dataType</span><span class="p">:</span><span class="w"> </span><span class="p">.</span><span class="n">double</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="accessing-data">
<h4>Accessing Data:<a class="headerlink" href="#accessing-data" title="Link to this heading">#</a></h4>
<p>Reading data:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">scalars()</span></code>: Returns a copy of the tensor’s elements as a new <code class="docutils literal notranslate"><span class="pre">[T]</span></code> array.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">withUnsafeBytes(_:)</span></code>: Provides a type-safe, immutable buffer pointer (<code class="docutils literal notranslate"><span class="pre">UnsafeBufferPointer&lt;T&gt;</span></code>) for efficient, direct memory access without creating a new array.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bytesWithHandler:</span></code>: The Objective-C and <code class="docutils literal notranslate"><span class="pre">AnyTensor</span></code> approach, which uses a callback with a raw <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*</span></code> pointer and requires manual type casting.</p></li>
</ul>
<p>Objective-C:</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">tensor</span><span class="w"> </span><span class="n">bytesWithHandler</span><span class="o">:^</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pointer</span><span class="p">,</span><span class="w"> </span><span class="n">NSInteger</span><span class="w"> </span><span class="n">count</span><span class="p">,</span><span class="w"> </span><span class="n">ExecuTorchDataType</span><span class="w"> </span><span class="n">dataType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dataType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ExecuTorchDataTypeFloat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">floatPointer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">pointer</span><span class="p">;</span>
<span class="w">    </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;First float element: %f&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">floatPointer</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}];</span>
</pre></div>
</div>
<p>Swift:</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nv">tensor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Tensor</span><span class="p">&lt;</span><span class="nb">Float</span><span class="p">&gt;([</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0</span><span class="p">,</span><span class="w"> </span><span class="mf">4.0</span><span class="p">],</span><span class="w"> </span><span class="n">shape</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">])</span>

<span class="c1">// Get data copy as a Swift array.</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">scalars</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tensor</span><span class="p">.</span><span class="n">scalars</span><span class="p">()</span>
<span class="bp">print</span><span class="p">(</span><span class="s">&quot;All scalars: </span><span class="si">\(</span><span class="n">scalars</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">// [1.0, 2.0, 3.0, 4.0]</span>

<span class="c1">// Access data via a buffer pointer.</span>
<span class="n">tensor</span><span class="p">.</span><span class="n">withUnsafeBytes</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="k">in</span>
<span class="w">  </span><span class="bp">print</span><span class="p">(</span><span class="s">&quot;First float element: </span><span class="si">\(</span><span class="n">buffer</span><span class="p">.</span><span class="bp">first</span><span class="w"> </span><span class="p">??</span><span class="w"> </span><span class="mf">0.0</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">anyTensor</span><span class="p">.</span><span class="n">bytes</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">pointer</span><span class="p">,</span><span class="w"> </span><span class="bp">count</span><span class="p">,</span><span class="w"> </span><span class="n">dataType</span><span class="w"> </span><span class="k">in</span>
<span class="w">  </span><span class="c1">// Must check data type and manually cast the pointer for type-erased tensor.</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">dataType</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="p">.</span><span class="n">float</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nv">buffer</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">UnsafeBufferPointer</span><span class="p">(</span><span class="n">start</span><span class="p">:</span><span class="w"> </span><span class="n">pointer</span><span class="p">.</span><span class="n">assumingMemoryBound</span><span class="p">(</span><span class="n">to</span><span class="p">:</span><span class="w"> </span><span class="nb">Float</span><span class="p">.</span><span class="kc">self</span><span class="p">),</span><span class="w"> </span><span class="bp">count</span><span class="p">:</span><span class="w"> </span><span class="bp">count</span><span class="p">)</span>
<span class="w">    </span><span class="bp">print</span><span class="p">(</span><span class="s">&quot;First float element from AnyTensor: </span><span class="si">\(</span><span class="n">buffer</span><span class="p">.</span><span class="bp">first</span><span class="w"> </span><span class="p">??</span><span class="w"> </span><span class="mf">0.0</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Modifying Data:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">withUnsafeMutableBytes(_:)</span></code>: The preferred Swift method. Provides a type-safe, mutable buffer pointer (<code class="docutils literal notranslate"><span class="pre">UnsafeMutableBufferPointer&lt;T&gt;</span></code>) for in-place modification.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mutableBytesWithHandler:</span></code>: The Objective-C and <code class="docutils literal notranslate"><span class="pre">AnyTensor</span></code> equivalent.</p></li>
</ul>
<p>Objective-C:</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">tensor</span><span class="w"> </span><span class="n">mutableBytesWithHandler</span><span class="o">:^</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pointer</span><span class="p">,</span><span class="w"> </span><span class="n">NSInteger</span><span class="w"> </span><span class="n">count</span><span class="p">,</span><span class="w"> </span><span class="n">ExecuTorchDataType</span><span class="w"> </span><span class="n">dataType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dataType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ExecuTorchDataTypeFloat</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">floatPointer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">pointer</span><span class="p">;</span>
<span class="w">    </span><span class="n">floatPointer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100.0f</span><span class="p">;</span><span class="w"> </span><span class="c1">// Modify the tensor&#39;s data.</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}];</span>
</pre></div>
</div>
<p>Swift:</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nv">tensor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Tensor</span><span class="p">&lt;</span><span class="nb">Float</span><span class="p">&gt;([</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0</span><span class="p">,</span><span class="w"> </span><span class="mf">4.0</span><span class="p">],</span><span class="w"> </span><span class="n">shape</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">])</span>

<span class="c1">// Modify the tensor&#39;s data in place.</span>
<span class="n">tensor</span><span class="p">.</span><span class="n">withUnsafeMutableBytes</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="k">in</span>
<span class="w">  </span><span class="n">buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">200.0</span>
<span class="p">}</span>
<span class="c1">// tensor&#39;s data is now [1.0, 200.0, 3.0, 4.0]</span>

<span class="n">anyTensor</span><span class="p">.</span><span class="n">mutableBytes</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">pointer</span><span class="p">,</span><span class="w"> </span><span class="bp">count</span><span class="p">,</span><span class="w"> </span><span class="n">dataType</span><span class="w"> </span><span class="k">in</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">dataType</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="p">.</span><span class="n">float</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nv">buffer</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">UnsafeMutableBufferPointer</span><span class="p">(</span><span class="n">start</span><span class="p">:</span><span class="w"> </span><span class="n">pointer</span><span class="p">.</span><span class="n">assumingMemoryBound</span><span class="p">(</span><span class="n">to</span><span class="p">:</span><span class="w"> </span><span class="nb">Float</span><span class="p">.</span><span class="kc">self</span><span class="p">),</span><span class="w"> </span><span class="bp">count</span><span class="p">:</span><span class="w"> </span><span class="bp">count</span><span class="p">)</span>
<span class="w">    </span><span class="n">buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">100.0</span><span class="w"> </span><span class="c1">// Modify the AnyTensor&#39;s data</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="resizing">
<h4>Resizing:<a class="headerlink" href="#resizing" title="Link to this heading">#</a></h4>
<p>Tensors can be resized if their shape dynamism is not <code class="docutils literal notranslate"><span class="pre">.static</span></code>. Resizing only changes the tensor’s metadata (shape and strides) and does not reallocate or change the underlying data, so the new shape must have the same total number of elements.</p>
<p>Objective-C:</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="bp">NSError</span><span class="w"> </span><span class="o">*</span><span class="n">error</span><span class="p">;</span>
<span class="kt">BOOL</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">tensor</span><span class="w"> </span><span class="n">resizeToShape</span><span class="o">:</span><span class="l">@[</span><span class="mi">@4</span><span class="p">,</span><span class="w"> </span><span class="mi">@1</span><span class="l">]</span><span class="w"> </span><span class="n">error</span><span class="o">:&amp;</span><span class="n">error</span><span class="p">];</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">success</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Resized shape: %@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">tensor</span><span class="p">.</span><span class="n">shape</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Resize failed: %@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Swift:</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="k">do</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="n">tensor</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">to</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span>
<span class="w">  </span><span class="bp">print</span><span class="p">(</span><span class="s">&quot;Resized shape: </span><span class="si">\(</span><span class="n">tensor</span><span class="p">.</span><span class="n">shape</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="bp">print</span><span class="p">(</span><span class="s">&quot;Resize failed: </span><span class="si">\(</span><span class="n">error</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="equality">
<h4>Equality:<a class="headerlink" href="#equality" title="Link to this heading">#</a></h4>
<p>You can check if two tensors are equal using the <code class="docutils literal notranslate"><span class="pre">==</span></code> operator. It compares their data type, shape, strides, dimension order, and all underlying element data. The <code class="docutils literal notranslate"><span class="pre">shapeDynamism</span></code> property is disregarded in this comparison.</p>
</section>
<section id="printing">
<h4>Printing:<a class="headerlink" href="#printing" title="Link to this heading">#</a></h4>
<p>Tensors conform to <code class="docutils literal notranslate"><span class="pre">CustomStringConvertible</span></code> in Swift and implement <code class="docutils literal notranslate"><span class="pre">-description</span></code> in Objective-C, so you can print them directly to the console for easy debugging.</p>
</section>
</section>
<section id="value">
<h3>Value<a class="headerlink" href="#value" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Value</span></code> class (exposed as <code class="docutils literal notranslate"><span class="pre">ExecuTorchValue</span></code> in Objective-C) is a dynamic container that can hold different types of data, primarily used for model inputs and outputs. ExecuTorch methods accept and return arrays of <code class="docutils literal notranslate"><span class="pre">Value</span></code> objects.</p>
<section id="id1">
<h4>Key Properties:<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tag</span></code>: Indicates the type of data held (e.g., <code class="docutils literal notranslate"><span class="pre">.tensor</span></code>, <code class="docutils literal notranslate"><span class="pre">.integer</span></code>, <code class="docutils literal notranslate"><span class="pre">.string</span></code>, <code class="docutils literal notranslate"><span class="pre">.boolean</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">isTensor</span></code>, <code class="docutils literal notranslate"><span class="pre">isInteger</span></code>, <code class="docutils literal notranslate"><span class="pre">isString</span></code>, etc.: Boolean checks for the type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tensor</span></code>, <code class="docutils literal notranslate"><span class="pre">integer</span></code>, <code class="docutils literal notranslate"><span class="pre">string</span></code>, <code class="docutils literal notranslate"><span class="pre">boolean</span></code>, <code class="docutils literal notranslate"><span class="pre">double</span></code>: Accessors for the underlying data (return <code class="docutils literal notranslate"><span class="pre">nil</span></code> or a default value if the tag doesn’t match).</p></li>
</ul>
</section>
<section id="id2">
<h4>Initialization:<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<p>Create Value objects directly from the data they should hold.</p>
<p>Objective-C:</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="cp">#import &lt;ExecuTorch/ExecuTorch.h&gt;</span>

<span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="o">*</span><span class="n">tensor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithFloat</span><span class="o">:</span><span class="mf">1.0f</span><span class="p">];</span>

<span class="n">ExecuTorchValue</span><span class="w"> </span><span class="o">*</span><span class="n">tensorValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">ExecuTorchValue</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">valueWithTensor</span><span class="o">:</span><span class="n">tensor</span><span class="p">];</span>
<span class="n">ExecuTorchValue</span><span class="w"> </span><span class="o">*</span><span class="n">intValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">ExecuTorchValue</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">valueWithInteger</span><span class="o">:</span><span class="mi">100</span><span class="p">];</span>
<span class="n">ExecuTorchValue</span><span class="w"> </span><span class="o">*</span><span class="n">stringValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">ExecuTorchValue</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">valueWithString</span><span class="o">:</span><span class="s">@&quot;hello&quot;</span><span class="p">];</span>
<span class="n">ExecuTorchValue</span><span class="w"> </span><span class="o">*</span><span class="n">boolValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">ExecuTorchValue</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">valueWithBoolean</span><span class="o">:</span><span class="nb">YES</span><span class="p">];</span>
<span class="n">ExecuTorchValue</span><span class="w"> </span><span class="o">*</span><span class="n">doubleValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">ExecuTorchValue</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">valueWithDouble</span><span class="o">:</span><span class="mf">3.14</span><span class="p">];</span>
</pre></div>
</div>
<p>Swift:</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="kd">import</span><span class="w"> </span><span class="nc">ExecuTorch</span>

<span class="kd">let</span><span class="w"> </span><span class="nv">tensor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Tensor</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>

<span class="kd">let</span><span class="w"> </span><span class="nv">tensorValue</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Value</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">intValue</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Value</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">stringValue</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Value</span><span class="p">(</span><span class="s">&quot;world&quot;</span><span class="p">)</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">boolValue</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Value</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">doubleValue</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Value</span><span class="p">(</span><span class="mf">2.718</span><span class="p">)</span>
</pre></div>
</div>
<p>Also, in Swift, all the types that <code class="docutils literal notranslate"><span class="pre">Value</span></code> can hold conform to the <code class="docutils literal notranslate"><span class="pre">ValueConvertible</span></code> protocol, so you can create <code class="docutils literal notranslate"><span class="pre">Value</span></code> objects directly from them without explicitly wrapping them in <code class="docutils literal notranslate"><span class="pre">Value</span></code> constructors:</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span><span class="w"> </span><span class="nf">processValue</span><span class="p">(</span><span class="kc">_</span><span class="w"> </span><span class="n">value</span><span class="p">:</span><span class="w"> </span><span class="n">ValueConvertible</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// ...</span>
<span class="p">}</span>

<span class="n">processValue</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="c1">// Value&lt;Int&gt;</span>
<span class="n">processValue</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span><span class="w"> </span><span class="c1">// Value&lt;Double&gt;</span>
<span class="n">processValue</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">// Value&lt;String&gt;</span>
<span class="n">processValue</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="c1">// Value&lt;Bool&gt;</span>
<span class="n">processValue</span><span class="p">(</span><span class="n">Tensor</span><span class="p">(</span><span class="mf">1.0</span><span class="p">))</span><span class="w"> </span><span class="c1">// Value&lt;Tensor&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="module">
<h3>Module<a class="headerlink" href="#module" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Module</span></code> class (exposed as <code class="docutils literal notranslate"><span class="pre">ExecuTorchModule</span></code> in Objective-C) represents a loaded ExecuTorch model (<code class="docutils literal notranslate"><span class="pre">.pte</span></code> file). It provides methods to load the model program, inspect its methods, and execute them for inference.</p>
<p>Note: <code class="docutils literal notranslate"><span class="pre">Module</span></code> and its methods are not thread-safe. If you need to do concurrent inferences from multiple threads, create one <code class="docutils literal notranslate"><span class="pre">Module</span></code> per thread.</p>
<section id="id3">
<h4>Initialization:<a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<p>Create a <code class="docutils literal notranslate"><span class="pre">Module</span></code> instance by providing the file path to the <code class="docutils literal notranslate"><span class="pre">.pte</span></code> model. Initialization itself is lightweight and doesn’t load the program data immediately. You can also specify a <code class="docutils literal notranslate"><span class="pre">ModuleLoadMode</span></code> to control how the file is loaded, such as using memory mapping for efficiency.</p>
<p>Objective-C:</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="cp">#import &lt;ExecuTorch/ExecuTorch.h&gt;</span>

<span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">modelPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSBundle</span><span class="w"> </span><span class="n">mainBundle</span><span class="p">]</span><span class="w"> </span><span class="n">pathForResource</span><span class="o">:</span><span class="s">@&quot;model&quot;</span><span class="w"> </span><span class="n">ofType</span><span class="o">:</span><span class="s">@&quot;pte&quot;</span><span class="p">];</span>
<span class="n">ExecuTorchModule</span><span class="w"> </span><span class="o">*</span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">ExecuTorchModule</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithFilePath</span><span class="o">:</span><span class="n">modelPath</span><span class="p">];</span>

<span class="c1">// Optional: specify load mode, e.g., memory mapping.</span>
<span class="n">ExecuTorchModule</span><span class="w"> </span><span class="o">*</span><span class="n">moduleMmap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">ExecuTorchModule</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithFilePath</span><span class="o">:</span><span class="n">modelPath</span>
<span class="w">                                                                 </span><span class="nl">loadMode</span><span class="p">:</span><span class="n">ExecuTorchModuleLoadModeMmap</span><span class="p">];</span>
</pre></div>
</div>
<p>Swift:</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="kd">import</span><span class="w"> </span><span class="nc">ExecuTorch</span>

<span class="kd">let</span><span class="w"> </span><span class="nv">modelPath</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Bundle</span><span class="p">.</span><span class="n">main</span><span class="p">.</span><span class="n">path</span><span class="p">(</span><span class="n">forResource</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;model&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ofType</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;pte&quot;</span><span class="p">)</span><span class="o">!</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">module</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Module</span><span class="p">(</span><span class="n">filePath</span><span class="p">:</span><span class="w"> </span><span class="n">modelPath</span><span class="p">)</span>

<span class="c1">// Optional: specify load mode, e.g., memory mapping.</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">moduleMmap</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Module</span><span class="p">(</span><span class="n">filePath</span><span class="p">:</span><span class="w"> </span><span class="n">modelPath</span><span class="p">,</span><span class="w"> </span><span class="n">loadMode</span><span class="p">:</span><span class="w"> </span><span class="p">.</span><span class="n">mmap</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="loading">
<h4>Loading:<a class="headerlink" href="#loading" title="Link to this heading">#</a></h4>
<p>Model loading is deferred until explicitly requested or needed. You can load the entire program or individual methods. While execution calls can trigger loading automatically, it’s often more efficient to load methods explicitly beforehand.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">load()</span></code>: Loads the basic program structure. You can specify a <code class="docutils literal notranslate"><span class="pre">ModuleVerification</span></code> level, though minimal verification is used by default.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">load(_:)</span></code>: Loads the program structure and prepares a specific method (e.g., “forward”) for execution. This performs necessary setup like backend delegation and is recommended if you know which method you’ll run.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">isLoaded()</span></code> / <code class="docutils literal notranslate"><span class="pre">isLoaded(_:)</span></code>: Check loading status.</p></li>
</ul>
<p>Objective-C:</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="bp">NSError</span><span class="w"> </span><span class="o">*</span><span class="n">error</span><span class="p">;</span>
<span class="c1">// Loads program and prepares &#39;forward&#39; for execution.</span>
<span class="kt">BOOL</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">module</span><span class="w"> </span><span class="n">loadMethod</span><span class="o">:</span><span class="s">@&quot;forward&quot;</span><span class="w"> </span><span class="n">error</span><span class="o">:&amp;</span><span class="n">error</span><span class="p">];</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">success</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Forward method loaded: %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">module</span><span class="w"> </span><span class="n">isMethodLoaded</span><span class="o">:</span><span class="s">@&quot;forward&quot;</span><span class="p">]);</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Failed to load method: %@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Swift:</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="k">do</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Loads program and prepares &#39;forward&#39; for execution.</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="n">module</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;forward&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="bp">print</span><span class="p">(</span><span class="s">&quot;Forward method loaded: </span><span class="si">\(</span><span class="n">module</span><span class="p">.</span><span class="n">isLoaded</span><span class="si">(</span><span class="s">&quot;forward&quot;</span><span class="si">))</span><span class="s">&quot;</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="bp">print</span><span class="p">(</span><span class="s">&quot;Failed to load method: </span><span class="si">\(</span><span class="n">error</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="inspecting-method-metadata">
<h4>Inspecting Method Metadata<a class="headerlink" href="#inspecting-method-metadata" title="Link to this heading">#</a></h4>
<p>You can programmatically inspect a method’s contract—its input/output types, tensor shapes, data types, and more—by retrieving its MethodMetadata. This is incredibly useful for building dynamic applications that can adapt to different models without hardcoding dimensions.</p>
<p>Objective-c:</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="bp">NSError</span><span class="w"> </span><span class="o">*</span><span class="n">error</span><span class="p">;</span>
<span class="n">ExecuTorchMethodMetadata</span><span class="w"> </span><span class="o">*</span><span class="n">metadata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">module</span><span class="w"> </span><span class="n">methodMetadata</span><span class="o">:</span><span class="s">@&quot;forward&quot;</span><span class="w"> </span><span class="n">error</span><span class="o">:&amp;</span><span class="n">error</span><span class="p">];</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Check if the first input is a tensor.</span>
<span class="w">  </span><span class="n">ExecuTorchValueTag</span><span class="w"> </span><span class="n">firstInputTag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">metadata</span><span class="p">.</span><span class="n">inputValueTags</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="n">unsignedIntValue</span><span class="p">];</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">firstInputTag</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ExecuTorchValueTagTensor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Get the metadata for the first input tensor.</span>
<span class="w">    </span><span class="n">ExecuTorchTensorMetadata</span><span class="w"> </span><span class="o">*</span><span class="n">tensorMeta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">metadata</span><span class="p">.</span><span class="n">inputTensorMetadata</span><span class="p">[</span><span class="mi">@0</span><span class="p">];</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tensorMeta</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Expected input shape: %@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">tensorMeta</span><span class="p">.</span><span class="n">shape</span><span class="p">);</span>
<span class="w">      </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Expected input data type: %ld&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">tensorMeta</span><span class="p">.</span><span class="n">dataType</span><span class="p">);</span>
<span class="w">      </span><span class="c1">// You can now dynamically create a matching input tensor.</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Swift:</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="k">do</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Easily inspect the &quot;forward&quot; method at runtime.</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nv">metadata</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">module</span><span class="p">.</span><span class="n">methodMetadata</span><span class="p">(</span><span class="s">&quot;forward&quot;</span><span class="p">)</span>

<span class="w">  </span><span class="c1">// Check if the first input is a tensor and get its metadata.</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n">metadata</span><span class="p">.</span><span class="n">inputValueTags</span><span class="p">.</span><span class="bp">first</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="p">.</span><span class="n">tensor</span><span class="p">,</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nv">tensorMeta</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">metadata</span><span class="p">.</span><span class="n">inputTensorMetadata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="bp">print</span><span class="p">(</span><span class="s">&quot;Expected input shape: </span><span class="si">\(</span><span class="n">tensorMeta</span><span class="p">.</span><span class="n">shape</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="bp">print</span><span class="p">(</span><span class="s">&quot;Expected input data type: </span><span class="si">\(</span><span class="n">tensorMeta</span><span class="p">.</span><span class="n">dataType</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Dynamically create a random tensor that matches the model&#39;s input specs.</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nv">input</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">AnyTensor</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="n">shape</span><span class="p">:</span><span class="w"> </span><span class="n">tensorMeta</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span><span class="w"> </span><span class="n">dataType</span><span class="p">:</span><span class="w"> </span><span class="n">tensorMeta</span><span class="p">.</span><span class="n">dataType</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Use the dynamically created tensor for inference.</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nv">outputs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">module</span><span class="p">.</span><span class="n">forward</span><span class="p">(</span><span class="n">input</span><span class="p">)</span>
<span class="w">    </span><span class="bp">print</span><span class="p">(</span><span class="s">&quot;Successfully ran inference with dynamic input.&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="bp">print</span><span class="p">(</span><span class="s">&quot;Failed to get metadata or run inference: </span><span class="si">\(</span><span class="n">error</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="execution">
<h4>Execution:<a class="headerlink" href="#execution" title="Link to this heading">#</a></h4>
<p>The Module class offers flexible ways to execute methods.
Inputs can be any type conforming to <code class="docutils literal notranslate"><span class="pre">ValueConvertible</span></code> (like <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="docutils literal notranslate"><span class="pre">Int</span></code>, <code class="docutils literal notranslate"><span class="pre">Float</span></code>, <code class="docutils literal notranslate"><span class="pre">Bool</span></code>, etc.).</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">execute(_:_:)</span></code>: Execute any available method by name with one or more inputs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forward(_:)</span></code>: A convenient shortcut for executing the common “forward” method.</p></li>
</ul>
<p>The API provides overloads for single inputs, multiple inputs, or no inputs.</p>
<p>Outputs are returned in two ways:</p>
<ul class="simple">
<li><p>As an array of <code class="docutils literal notranslate"><span class="pre">Value</span></code>s, letting you inspect and cast results yourself.</p></li>
<li><p>As your expected type. The generic overloads decode the result directly into your desired Swift type (such as a single <code class="docutils literal notranslate"><span class="pre">Tensor&lt;Float&gt;</span></code>, an array, or any custom type conforming to the <code class="docutils literal notranslate"><span class="pre">ValueSequenceConstructible</span></code> protocol). If the output doesn’t match the expected type (e.g. multiple Values returned when a single object is expected, or a tensor data type mismatch), an invalid type error is thrown.</p></li>
</ul>
<p>Objective-C:</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="o">*</span><span class="n">inputTensor1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithScalars</span><span class="o">:</span><span class="l">@[</span><span class="mf">@1.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">@2.0f</span><span class="l">]</span><span class="p">];</span>
<span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="o">*</span><span class="n">inputTensor2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithScalars</span><span class="o">:</span><span class="l">@[</span><span class="mf">@3.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">@4.0f</span><span class="l">]</span><span class="p">];</span>
<span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="o">*</span><span class="n">singleInputTensor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithFloat</span><span class="o">:</span><span class="mf">5.0f</span><span class="p">];</span>
<span class="bp">NSError</span><span class="w"> </span><span class="o">*</span><span class="n">error</span><span class="p">;</span>

<span class="c1">// Execute &quot;forward&quot; using the shortcut with an array of Tensors.</span>
<span class="bp">NSArray</span><span class="o">&lt;</span><span class="n">ExecuTorchValue</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="n">outputs1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">module</span><span class="w"> </span><span class="n">forwardWithTensors</span><span class="o">:</span><span class="l">@[</span><span class="n">inputTensor1</span><span class="p">,</span><span class="w"> </span><span class="n">inputTensor2</span><span class="l">]</span><span class="w"> </span><span class="n">error</span><span class="o">:&amp;</span><span class="n">error</span><span class="p">];</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">outputs1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Forward output count: %lu&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="n">outputs1</span><span class="p">.</span><span class="n">count</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Execution failed: %@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Execute &quot;forward&quot; with a single Tensor input.</span>
<span class="bp">NSArray</span><span class="o">&lt;</span><span class="n">ExecuTorchValue</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="n">outputs2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">module</span><span class="w"> </span><span class="n">forwardWithTensor</span><span class="o">:</span><span class="n">singleInputTensor</span><span class="w"> </span><span class="n">error</span><span class="o">:&amp;</span><span class="n">error</span><span class="p">];</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">outputs2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Forward single input output count: %lu&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="n">outputs2</span><span class="p">.</span><span class="n">count</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Execution failed: %@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Execute a potentially different method by name.</span>
<span class="bp">NSArray</span><span class="o">&lt;</span><span class="n">ExecuTorchValue</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="n">outputs3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">module</span><span class="w"> </span><span class="n">executeMethod</span><span class="o">:</span><span class="s">@&quot;another_method&quot;</span>
<span class="w">                                                   </span><span class="nl">withInput</span><span class="p">:[[</span><span class="n">ExecuTorchValue</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">valueWithTensor</span><span class="o">:</span><span class="n">inputTensor1</span><span class="p">]</span>
<span class="w">                                                       </span><span class="nl">error</span><span class="p">:</span><span class="o">&amp;</span><span class="n">error</span><span class="p">];</span>

<span class="c1">// Process outputs (assuming first output is a tensor).</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">outputs1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">ExecuTorchValue</span><span class="w"> </span><span class="o">*</span><span class="n">firstOutput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">outputs1</span><span class="p">.</span><span class="n">firstObject</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">firstOutput</span><span class="p">.</span><span class="n">isTensor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ExecuTorchTensor</span><span class="w"> </span><span class="o">*</span><span class="n">resultTensor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">firstOutput</span><span class="p">.</span><span class="n">tensorValue</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// Process resultTensor.</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Swift:</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nv">inputTensor1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Tensor</span><span class="p">&lt;</span><span class="nb">Float</span><span class="p">&gt;([</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">])</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">inputTensor2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Tensor</span><span class="p">&lt;</span><span class="nb">Float</span><span class="p">&gt;([</span><span class="mf">3.0</span><span class="p">,</span><span class="w"> </span><span class="mf">4.0</span><span class="p">])</span>
<span class="kd">let</span><span class="w"> </span><span class="nv">singleInputTensor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Tensor</span><span class="p">&lt;</span><span class="nb">Float</span><span class="p">&gt;([</span><span class="mf">5.0</span><span class="p">])</span>

<span class="k">do</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Execute &quot;forward&quot; using the shortcut with an array of Tensors.</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nv">outputs1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">module</span><span class="p">.</span><span class="n">forward</span><span class="p">([</span><span class="n">inputTensor1</span><span class="p">,</span><span class="w"> </span><span class="n">inputTensor2</span><span class="p">])</span>
<span class="w">  </span><span class="bp">print</span><span class="p">(</span><span class="s">&quot;Forward output count: </span><span class="si">\(</span><span class="n">outputs1</span><span class="p">.</span><span class="bp">count</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>

<span class="w">  </span><span class="c1">// Execute &quot;forward&quot; with a single Tensor input.</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nv">outputs2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">module</span><span class="p">.</span><span class="n">forward</span><span class="p">(</span><span class="n">singleInputTensor</span><span class="p">)</span>
<span class="w">  </span><span class="bp">print</span><span class="p">(</span><span class="s">&quot;Forward single input output count: </span><span class="si">\(</span><span class="n">outputs2</span><span class="p">.</span><span class="bp">count</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>

<span class="w">  </span><span class="c1">// Execute a potentially different method by name.</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nv">outputs3</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">module</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">&quot;another_method&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">inputTensor1</span><span class="p">])</span>

<span class="w">  </span><span class="c1">// Process outputs by converting the first output Value to a typed Tensor&lt;Float&gt;.</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="nv">outputTensor</span><span class="p">:</span><span class="w"> </span><span class="n">Tensor</span><span class="p">&lt;</span><span class="nb">Float</span><span class="p">&gt;</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">outputs1</span><span class="p">.</span><span class="bp">first</span><span class="p">?.</span><span class="n">tensor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Now you have a type-safe tensor and can access its data easily.</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nv">logits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">outputTensor</span><span class="p">.</span><span class="n">scalars</span><span class="p">()</span>
<span class="w">    </span><span class="bp">print</span><span class="p">(</span><span class="s">&quot;First 5 logits: </span><span class="si">\(</span><span class="n">logits</span><span class="p">.</span><span class="kr">prefix</span><span class="si">(</span><span class="mi">5</span><span class="si">))</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Try casting the outputs to a single typed object.</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nv">tensorOutput</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">Tensor</span><span class="p">&lt;</span><span class="nb">Float</span><span class="p">&gt;(</span><span class="n">module</span><span class="p">.</span><span class="n">forward</span><span class="p">(</span><span class="n">inputTensor1</span><span class="p">,</span><span class="w"> </span><span class="n">inputTensor2</span><span class="p">))</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nv">logits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tensorOutput</span><span class="p">.</span><span class="n">scalars</span><span class="p">()</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="bp">print</span><span class="p">(</span><span class="s">&quot;Execution failed: </span><span class="si">\(</span><span class="n">error</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="method-names">
<h4>Method Names:<a class="headerlink" href="#method-names" title="Link to this heading">#</a></h4>
<p>You can query the available method names in the model after the program is loaded.</p>
<p>Objective-C:</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="bp">NSError</span><span class="w"> </span><span class="o">*</span><span class="n">error</span><span class="p">;</span>

<span class="c1">// Note: methodNames: will load the program if not already loaded.</span>
<span class="bp">NSSet</span><span class="o">&lt;</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*&gt;</span><span class="w"> </span><span class="o">*</span><span class="n">names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">module</span><span class="w"> </span><span class="n">methodNames</span><span class="o">:&amp;</span><span class="n">error</span><span class="p">];</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Available methods: %@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">names</span><span class="p">);</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Could not get method names: %@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Swift:</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="k">do</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Note: methodNames() will load the program if not already loaded.</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nv">names</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">module</span><span class="p">.</span><span class="n">methodNames</span><span class="p">()</span>
<span class="w">  </span><span class="bp">print</span><span class="p">(</span><span class="s">&quot;Available methods: </span><span class="si">\(</span><span class="n">names</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">// Output: e.g., {&quot;forward&quot;}</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="bp">print</span><span class="p">(</span><span class="s">&quot;Could not get method names: </span><span class="si">\(</span><span class="n">error</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="logging">
<h3>Logging<a class="headerlink" href="#logging" title="Link to this heading">#</a></h3>
<p>ExecuTorch provides APIs for logging in Objective-C and Swift via the <code class="docutils literal notranslate"><span class="pre">ExecuTorchLog</span></code> (<code class="docutils literal notranslate"><span class="pre">Log</span></code> in Swift) singleton. You can subscribe custom log sinks conforming to the <code class="docutils literal notranslate"><span class="pre">ExecuTorchLogSink</span></code> (<code class="docutils literal notranslate"><span class="pre">LogSink</span></code> in Swift) protocol to receive internal ExecuTorch log messages.</p>
<p><strong>Note:</strong> Logs are stripped in the Release builds of ExecuTorch frameworks. To capture logs, link against the Debug builds (e.g., <code class="docutils literal notranslate"><span class="pre">executorch_debug</span></code>) during development.</p>
<p>Objective-C:</p>
<div class="highlight-objectivec notranslate"><div class="highlight"><pre><span></span><span class="cp">#import &lt;ExecuTorch/ExecuTorch.h&gt;</span>
<span class="cp">#import &lt;os/log.h&gt;</span>

<span class="k">@interface</span> <span class="bp">MyClass</span> : <span class="bp">NSObject</span><span class="o">&lt;</span><span class="n">ExecuTorchLogSink</span><span class="o">&gt;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="bp">MyClass</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">init</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nb">self</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nb">super</span><span class="w"> </span><span class="n">init</span><span class="p">];</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">self</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="cp">#if DEBUG</span>
<span class="w">    </span><span class="p">[</span><span class="n">ExecuTorchLog</span><span class="p">.</span><span class="n">sharedLog</span><span class="w"> </span><span class="n">addSink</span><span class="o">:</span><span class="nb">self</span><span class="p">];</span>
<span class="cp">#endif</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">self</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">dealloc</span><span class="w"> </span><span class="p">{</span>
<span class="cp">#if DEBUG</span>
<span class="w">  </span><span class="p">[</span><span class="n">ExecuTorchLog</span><span class="p">.</span><span class="n">sharedLog</span><span class="w"> </span><span class="n">removeSink</span><span class="o">:</span><span class="nb">self</span><span class="p">];</span>
<span class="cp">#endif</span>
<span class="p">}</span>

<span class="cp">#if DEBUG</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">logWithLevel:</span><span class="p">(</span><span class="n">ExecuTorchLogLevel</span><span class="p">)</span><span class="nv">level</span>
<span class="w">           </span><span class="nl">timestamp</span><span class="p">:(</span><span class="n">NSTimeInterval</span><span class="p">)</span><span class="nv">timestamp</span>
<span class="w">            </span><span class="nl">filename</span><span class="p">:(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">filename</span>
<span class="w">                </span><span class="nl">line</span><span class="p">:(</span><span class="n">NSUInteger</span><span class="p">)</span><span class="nv">line</span>
<span class="w">             </span><span class="nl">message</span><span class="p">:(</span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="nv">message</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">logMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">stringWithFormat</span><span class="o">:</span><span class="s">@&quot;%@:%lu %@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="n">line</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">];</span>
<span class="w">  </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">level</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">ExecuTorchLogLevelDebug</span><span class="p">:</span>
<span class="w">      </span><span class="n">os_log_with_type</span><span class="p">(</span><span class="n">OS_LOG_DEFAULT</span><span class="p">,</span><span class="w"> </span><span class="n">OS_LOG_TYPE_DEBUG</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%{public}@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">logMessage</span><span class="p">);</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">ExecuTorchLogLevelInfo</span><span class="p">:</span>
<span class="w">      </span><span class="n">os_log_with_type</span><span class="p">(</span><span class="n">OS_LOG_DEFAULT</span><span class="p">,</span><span class="w"> </span><span class="n">OS_LOG_TYPE_INFO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%{public}@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">logMessage</span><span class="p">);</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">ExecuTorchLogLevelError</span><span class="p">:</span>
<span class="w">      </span><span class="n">os_log_with_type</span><span class="p">(</span><span class="n">OS_LOG_DEFAULT</span><span class="p">,</span><span class="w"> </span><span class="n">OS_LOG_TYPE_ERROR</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%{public}@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">logMessage</span><span class="p">);</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">ExecuTorchLogLevelFatal</span><span class="p">:</span>
<span class="w">      </span><span class="n">os_log_with_type</span><span class="p">(</span><span class="n">OS_LOG_DEFAULT</span><span class="p">,</span><span class="w"> </span><span class="n">OS_LOG_TYPE_FAULT</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%{public}@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">logMessage</span><span class="p">);</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">default</span><span class="o">:</span>
<span class="w">      </span><span class="n">os_log</span><span class="p">(</span><span class="n">OS_LOG_DEFAULT</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%{public}@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">logMessage</span><span class="p">);</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
<span class="cp">#endif</span>

<span class="k">@end</span>
</pre></div>
</div>
<p>Swift:</p>
<div class="highlight-swift notranslate"><div class="highlight"><pre><span></span><span class="kd">import</span><span class="w"> </span><span class="nc">ExecuTorch</span>
<span class="kd">import</span><span class="w"> </span><span class="nc">os</span><span class="p">.</span><span class="nc">log</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="bp">MyClass</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="kd">init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cp">#if</span><span class="w"> </span><span class="cp">DEBUG</span>
<span class="w">    </span><span class="n">Log</span><span class="p">.</span><span class="n">shared</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">sink</span><span class="p">:</span><span class="w"> </span><span class="kc">self</span><span class="p">)</span>
<span class="w">    </span><span class="cp">#endif</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="kd">deinit</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cp">#if</span><span class="w"> </span><span class="cp">DEBUG</span>
<span class="w">    </span><span class="n">Log</span><span class="p">.</span><span class="n">shared</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">sink</span><span class="p">:</span><span class="w"> </span><span class="kc">self</span><span class="p">)</span>
<span class="w">    </span><span class="cp">#endif</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="cp">#if</span><span class="w"> </span><span class="cp">DEBUG</span>
<span class="kd">extension</span><span class="w"> </span><span class="bp">MyClass</span><span class="p">:</span><span class="w"> </span><span class="n">LogSink</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="kd">func</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">level</span><span class="p">:</span><span class="w"> </span><span class="n">LogLevel</span><span class="p">,</span><span class="w"> </span><span class="n">timestamp</span><span class="p">:</span><span class="w"> </span><span class="n">TimeInterval</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="p">:</span><span class="w"> </span><span class="nb">UInt</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nv">logMessage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;</span><span class="si">\(</span><span class="n">filename</span><span class="si">)</span><span class="s">:</span><span class="si">\(</span><span class="n">line</span><span class="si">)</span><span class="s"> </span><span class="si">\(</span><span class="n">message</span><span class="si">)</span><span class="s">&quot;</span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">.</span><span class="n">debug</span><span class="p">:</span>
<span class="w">      </span><span class="n">os_log</span><span class="p">(.</span><span class="n">debug</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%{public}@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">logMessage</span><span class="p">)</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">.</span><span class="n">info</span><span class="p">:</span>
<span class="w">      </span><span class="n">os_log</span><span class="p">(.</span><span class="n">info</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%{public}@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">logMessage</span><span class="p">)</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">.</span><span class="n">error</span><span class="p">:</span>
<span class="w">      </span><span class="n">os_log</span><span class="p">(.</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%{public}@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">logMessage</span><span class="p">)</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="p">.</span><span class="n">fatal</span><span class="p">:</span>
<span class="w">      </span><span class="n">os_log</span><span class="p">(.</span><span class="n">fault</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%{public}@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">logMessage</span><span class="p">)</span>
<span class="w">    </span><span class="k">default</span><span class="p">:</span>
<span class="w">      </span><span class="n">os_log</span><span class="p">(</span><span class="s">&quot;%{public}@&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">logMessage</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
<span class="cp">#endif</span>
</pre></div>
</div>
<p><strong>Note:</strong> In the example, the logs are intentionally stripped out when the code is not built for Debug mode, i.e., the <code class="docutils literal notranslate"><span class="pre">DEBUG</span></code> macro is not defined or equals zero.</p>
</section>
</section>
<section id="debugging">
<h2>Debugging<a class="headerlink" href="#debugging" title="Link to this heading">#</a></h2>
<p>If you are linking against a Debug build of the ExecuTorch frameworks, configure your debugger to map the source code correctly by using the following LLDB command in the debug session:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">settings</span> <span class="n">append</span> <span class="n">target</span><span class="o">.</span><span class="n">source</span><span class="o">-</span><span class="nb">map</span> <span class="o">/</span><span class="n">executorch</span> <span class="o">&lt;</span><span class="n">path_to_executorch_source_code</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Link to this heading">#</a></h2>
<section id="slow-execution">
<h3>Slow execution<a class="headerlink" href="#slow-execution" title="Link to this heading">#</a></h3>
<p>Ensure the exported model is using an appropriate backend, such as XNNPACK, Core ML, or MPS. If the correct backend is invoked but performance issues persist, confirm that you are linking against the Release build of the backend runtime.</p>
<p>For optimal performance, link the ExecuTorch runtime in Release mode too. If debugging is needed, you can keep the ExecuTorch runtime in Debug mode with minimal impact on performance, but preserve logging and debug symbols.</p>
</section>
<section id="swift-pm">
<h3>Swift PM<a class="headerlink" href="#swift-pm" title="Link to this heading">#</a></h3>
<p>If you encounter a checksum mismatch error with Swift PM, clear the package cache using the Xcode menu (<code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">&gt;</span> <span class="pre">Packages</span> <span class="pre">&gt;</span> <span class="pre">Reset</span> <span class="pre">Package</span> <span class="pre">Caches</span></code>) or the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rm<span class="w"> </span>-rf<span class="w"> </span>&lt;YouProjectName&gt;.xcodeproj/project.xcworkspace/xcshareddata/swiftpm<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>~/Library/org.swift.swiftpm<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>~/Library/Caches/org.swift.swiftpm<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>~/Library/Caches/com.apple.dt.Xcode<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>~/Library/Developer/Xcode/DerivedData
</pre></div>
</div>
<p><strong>Note:</strong> Ensure Xcode is fully quit before running the terminal command to avoid conflicts with active processes.</p>
</section>
</section>
</section>


                </article>
              
  </article>
  
              
              
                <footer class="bd-footer-article">
                  <div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item">
<div class="feedback">
  
<div class="rating">
    Rate this Page
    <div class="stars">
        
        <span class="star" data-behavior="tutorial-rating" data-count="1" data-value="1">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="2" data-value="2">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="3" data-value="3">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="4" data-value="4">★</span>
        
        <span class="star" data-behavior="tutorial-rating" data-count="5" data-value="5">★</span>
        
    </div>
</div>

  <div class="feedback-send">
    <button class="feedback-btn"
            onclick="openGitHubIssue()"
            data-bs-title="Create a GitHub Issue"
            data-bs-placement="bottom"
            data-bs-toggle="tooltip"
            data-gtm="feedback-btn-click">Send Feedback
    </button>
  </div>
</div>

<div class="prev-next-area">
    <a class="left-prev"
       href="ios-section.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">iOS</p>
      </div>
    </a>
    <a class="right-next"
       href="ios-backends.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Backends</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>

<div class="footer-info">
  <p class="copyright">
    
  </p>

  <p class="theme-version">
    Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
  </p>
</div>
</div>
  
</div>
                </footer>
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="ios-section.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">iOS</p>
      </div>
    </a>
    <a class="right-next"
       href="ios-backends.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Backends</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc">
<div class="sidebar-secondary-items sidebar-secondary__inner">
    
       <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integration">Integration</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#swift-package-manager">Swift Package Manager</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#xcode">Xcode</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cli">CLI</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-from-source">Building from Source</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linkage">Linkage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#runtime-api">Runtime API</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importing">Importing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor">Tensor</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#key-properties">Key Properties:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#initialization">Initialization:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#factory-methods">Factory Methods:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-data">Accessing Data:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#resizing">Resizing:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#equality">Equality:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#printing">Printing:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#value">Value</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Key Properties:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Initialization:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module">Module</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Initialization:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#loading">Loading:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#inspecting-method-metadata">Inspecting Method Metadata</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#execution">Execution:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#method-names">Method Names:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#logging">Logging</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#debugging">Debugging</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#troubleshooting">Troubleshooting</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#slow-execution">Slow execution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#swift-pm">Swift PM</a></li>
</ul>
</li>
</ul>
  </nav></div>
    
       <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/pytorch/executorch/edit/main/docs/source/using-executorch-ios.md">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>
    
       <div class="sidebar-secondary-item">
    <div class="tocsection sourcelink">
      <a href="_sources/using-executorch-ios.md.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
      </a>
    </div>
</div>
    




</div>
</div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  

<div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
  <div class="container">
    <div class="row">
      <div class="col-md-4">
        <h2>Docs</h2>
        <p>Access comprehensive developer documentation for PyTorch</p>
        <a class="with-right-arrow" href="https://docs.pytorch.org/docs/stable/index.html">View Docs</a>
      </div>

      <div class="col-md-4">
        <h2>Tutorials</h2>
        <p>Get in-depth tutorials for beginners and advanced developers</p>
        <a class="with-right-arrow" href="https://docs.pytorch.org/tutorials">View Tutorials</a>
      </div>

      <div class="col-md-4">
        <h2>Resources</h2>
        <p>Find development resources and get your questions answered</p>
        <a class="with-right-arrow" href="https://pytorch.org/resources">View Resources</a>
      </div>
    </div>
  </div>
</div>




<footer class="site-footer">

  <div class="container footer-container">

    <div class="newsletter" id="newsletter">

      <p class="newsletter__title is-style-max-width-800"><strong>Stay in touch</strong> for updates, event info, and
        the latest news</p>


      <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/embed/v2.js"></script>
      <script>
        hbspt.forms.create({
          region: "na1",
          portalId: "8112310",
          formId: "2fb2231c-000b-4ec5-88a0-1ab242549c9e"
        });
      </script>


      <p class="newsletter__privacy">By submitting this form, I consent to receive marketing emails from the LF and its
        projects regarding their events, training, research, developments, and related announcements. I understand that
        I can unsubscribe at any time using the links in the footers of the emails I receive. <a
          href="https://www.linuxfoundation.org/privacy/">Privacy Policy</a>.</p>

    </div>

    <div class="lf-grid">
      <ul class="social-links">
        <li><a href="https://www.facebook.com/pytorch" target="_blank" title="PyTorch on Facebook">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="-0.51 -0.26 26.45 26.45" aria-label="Facebook">
              <path fill="currentColor"
                d="M25.497 13.075c0-2.45-.698-4.848-2.011-6.911a12.765 12.765 0 0 0-5.398-4.73A12.671 12.671 0 0 0 11.008.38a12.705 12.705 0 0 0-6.529 2.95A12.827 12.827 0 0 0 .563 9.358a12.896 12.896 0 0 0-.07 7.201 12.831 12.831 0 0 0 3.801 6.103 12.709 12.709 0 0 0 6.471 3.078v-8.957H7.53v-3.708h3.235v-2.824c0-3.213 1.903-4.988 4.813-4.988.956.014 1.909.097 2.852.25V8.67h-1.607a1.83 1.83 0 0 0-1.518.497 1.854 1.854 0 0 0-.561 1.505v2.404h3.535l-.563 3.708h-2.97v8.957a12.725 12.725 0 0 0 7.697-4.337 12.87 12.87 0 0 0 3.054-8.328z" />
            </svg>
          </a></li>
        <li><a href="https://twitter.com/pytorch" target="_blank" title="PyTorch on X">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 300 300" aria-label="X">
              <path fill="currentColor"
                d="M178.57 127.15 290.27 0h-26.46l-97.03 110.38L89.34 0H0l117.13 166.93L0 300.25h26.46l102.4-116.59 81.8 116.59h89.34M36.01 19.54H76.66l187.13 262.13h-40.66" />
            </svg>
          </a></li>
        <li><a href="https://www.youtube.com/pytorch" target="_blank" title="PyTorch on YouTube">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0.21 0.27 34.45 25.07" aria-label="YouTube">
              <path fill="currentColor"
                d="M33.729 6.084s-.327-2.33-1.317-3.356a4.691 4.691 0 0 0-3.32-1.432c-4.634-.34-11.589-.34-11.589-.34h-.014s-6.954 0-11.59.342a4.692 4.692 0 0 0-3.32 1.432c-.993 1.025-1.315 3.354-1.315 3.354a52.189 52.189 0 0 0-.331 5.473v2.566c.014 1.829.125 3.656.331 5.472 0 0 .322 2.33 1.316 3.36 1.26 1.345 2.916 1.3 3.653 1.445 2.65.26 11.263.34 11.263.34s6.96-.01 11.597-.353a4.691 4.691 0 0 0 3.32-1.432c.993-1.026 1.316-3.356 1.316-3.356.206-1.817.316-3.644.33-5.473v-2.57a52.26 52.26 0 0 0-.33-5.472zM14.076 17.232V7.729l8.951 4.768-8.95 4.735z" />
            </svg>
          </a></li>
        <li><a href="https://www.linkedin.com/company/pytorch" target="_blank" title="PyTorch on LinkedIn">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="-10.23 -10.23 531.96 531.96" aria-label="LinkedIn">
              <rect width="512" height="512" rx="0" fill="currentColor" />
              <circle fill="#000" cx="142" cy="138" r="37" />
              <path stroke="#000" stroke-width="66" d="M244 194v198M142 194v198" />
              <path fill="#000"
                d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32" />
            </svg>
          </a></li>
        <li><a href="https://pytorch.slack.com" target="_blank" title="PyTorch Slack">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0.16 -0.03 21.19 21.19" aria-label="Slack">
              <path fill="currentColor"
                d="M4.896 13.27a2.147 2.147 0 0 1-2.141 2.142A2.147 2.147 0 0 1 .613 13.27c0-1.178.963-2.141 2.142-2.141h2.141v2.141zm1.08 0c0-1.178.962-2.141 2.141-2.141s2.142.963 2.142 2.141v5.363a2.147 2.147 0 0 1-2.142 2.141 2.147 2.147 0 0 1-2.141-2.142V13.27zm2.141-8.6a2.147 2.147 0 0 1-2.141-2.14c0-1.18.962-2.142 2.141-2.142s2.142.963 2.142 2.141v2.142H8.117zm0 1.08c1.179 0 2.141.962 2.141 2.141a2.147 2.147 0 0 1-2.141 2.142H2.755A2.147 2.147 0 0 1 .613 7.89c0-1.179.963-2.141 2.142-2.141h5.362zm8.599 2.141c0-1.179.963-2.141 2.141-2.141 1.179 0 2.143.962 2.143 2.14a2.147 2.147 0 0 1-2.142 2.142h-2.141V7.89zm-1.08 0a2.147 2.147 0 0 1-2.141 2.142 2.147 2.147 0 0 1-2.141-2.142V2.53c0-1.178.962-2.141 2.141-2.141s2.142.963 2.142 2.141v5.362zm-2.141 8.6c1.179 0 2.142.962 2.142 2.14a2.147 2.147 0 0 1-2.142 2.142 2.147 2.147 0 0 1-2.141-2.141V16.49h2.141zm0-1.08a2.147 2.147 0 0 1-2.141-2.141c0-1.179.962-2.142 2.141-2.142h5.362c1.179 0 2.142.963 2.142 2.142a2.147 2.147 0 0 1-2.142 2.142h-5.362z">
              </path>
            </svg>
          </a></li>
        <li><a href="https://pytorch.org/wechat" title="PyTorch on WeChat">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0.14 -0.17 38.02 33.02" aria-label="WeChat">
              <path fill="currentColor"
                d="M26.289 10.976a12.972 12.972 0 0 0-8.742 3.53 10.386 10.386 0 0 0-3.224 8.795c-1.326-.164-2.535-.345-3.75-.448a2.332 2.332 0 0 0-1.273.216c-1.18.666-2.311 1.418-3.652 2.255.246-1.112.405-2.087.687-3.024a1.15 1.15 0 0 0-.523-1.52C1.737 17.902.02 13.601 1.307 9.165c1.189-4.1 4.11-6.587 8.077-7.884A13.54 13.54 0 0 1 24.18 5.617a10.135 10.135 0 0 1 2.109 5.359zM10.668 9.594a1.564 1.564 0 0 0-2.095-1.472 1.52 1.52 0 0 0-.895 1.964 1.502 1.502 0 0 0 1.391.966 1.545 1.545 0 0 0 1.598-1.46v.002zm8.15-1.566a1.567 1.567 0 0 0-1.528 1.543 1.528 1.528 0 0 0 1.571 1.492 1.52 1.52 0 0 0 1.375-2.117 1.518 1.518 0 0 0-1.415-.919l-.003.001z">
              </path>
              <path fill="currentColor"
                d="M33.914 32.137c-1.075-.478-2.062-1.196-3.11-1.306-1.049-.11-2.145.494-3.24.605a10.821 10.821 0 0 1-8.781-2.864c-4.682-4.33-4.013-10.97 1.403-14.518 4.811-3.154 11.874-2.102 15.268 2.273a8.671 8.671 0 0 1-1.002 12.095c-1.046.929-1.422 1.693-.751 2.917.102.257.174.525.213.798zM21.68 20.292a1.264 1.264 0 1 0 .01-2.528 1.264 1.264 0 0 0-.01 2.528zm7.887-2.526a1.266 1.266 0 0 0-1.256 1.21 1.247 1.247 0 1 0 1.256-1.21z">
              </path>
            </svg>
          </a></li>
      </ul>
    </div>
    
    <div class="privacy-policy">
      <div class="copyright">
      
        <p>
          &copy; PyTorch. Copyright © The Linux Foundation®. All rights reserved. The Linux Foundation has registered
          trademarks and uses trademarks. For more information, including terms of use, privacy policy, and trademark
          usage, please see our <a href="https://www.linuxfoundation.org/legal/policies">Policies</a> page. <a
            href="https://www.linuxfoundation.org/trademark-usage">Trademark Usage</a>. <a
            href="http://www.linuxfoundation.org/privacy">Privacy Policy</a>.
        </p>
        
      </div>
    </div>


  </div>
</footer>

<div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="_static/img/pytorch-x.svg">
  </div>
</div>
  
  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, ExecuTorch.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  <script type="application/ld+json">
    {
       "@context": "https://schema.org",
       "@type": "Article",
       "name": "Using ExecuTorch on iOS",
       "headline": "Using ExecuTorch on iOS",
       "description": "PyTorch Documentation. Explore PyTorch, an open-source machine learning library that accelerates the path from research prototyping to production deployment. Discover tutorials, API references, and guides to help you build and deploy deep learning models efficiently.",
       "url": "/using-executorch-ios.html",
       "articleBody": "Using ExecuTorch on iOS# ExecuTorch supports both iOS and macOS via Objective-C, Swift, and C++. ExecuTorch also provides backends to leverage Core ML and Metal Performance Shaders (MPS) for hardware-accelerated execution on Apple platforms. Integration# The ExecuTorch Runtime for iOS and macOS (ARM64) is distributed as a collection of prebuilt .xcframework binary targets. These targets are compatible with both iOS and macOS devices and simulators and are available in both release and debug modes: executorch - Core runtime components executorch_llm - LLM-specific runtime components backend_coreml - Core ML backend backend_mps - MPS backend backend_xnnpack - XNNPACK backend kernels_llm - Custom kernels for LLMs kernels_optimized - Accelerated generic CPU kernels kernels_quantized - Quantized kernels kernels_torchao - Quantized CPU kernels from torchao Link your binary with the ExecuTorch runtime and any backends or kernels used by the exported ML model. It is recommended to link the core runtime to the components that use ExecuTorch directly, and link kernels and backends against the main app target. Note: You may need to add some extra linker flags for the build settings of the components that links against ExecuTorch backends or kernels to let them register properly at the app startup. See the Linkage section for more details. Note: To access logs, link against the Debug build of the ExecuTorch runtime, i.e., the executorch_debug framework. For optimal performance, always link against the Release version of the deliverables (those without the _debug suffix), which have all logging overhead removed. See the Logging section for more details. Swift Package Manager# The prebuilt ExecuTorch runtime, backend, and kernels are available as a Swift PM package. Xcode# In Xcode, go to File \u003e Add Package Dependencies. Paste the URL of the ExecuTorch repo into the search bar and select it. Make sure to change the branch name to the desired ExecuTorch version in format \u201cswiftpm-\u201d, (e.g. \u201cswiftpm-1.0.0\u201d), or a branch name in format \u201cswiftpm-.\u003cyear_month_date\u003e\u201d (e.g. \u201cswiftpm-1.1.0-20251101\u201d) for a nightly build on a specific date. Then select which ExecuTorch framework should link against which target. Click the screenshot below to watch the demo video on how to add the package and run a simple ExecuTorch model on iOS. CLI# Add a package and target dependencies on ExecuTorch to your package file like this: // swift-tools-version:5.9 import PackageDescription let package = Package( name: \"YourPackageName\", platforms: [ .iOS(.v17), .macOS(.v12), ], products: [ .library(name: \"YourPackageName\", targets: [\"YourTargetName\"]), ], dependencies: [ // Use \"swiftpm-\u003cversion\u003e.\u003cyear_month_day\u003e\" branch name for a nightly build. .package(url: \"https://github.com/pytorch/executorch.git\", branch: \"swiftpm-1.0.0\") ], targets: [ .target( name: \"YourTargetName\", dependencies: [ .product(name: \"executorch\", package: \"executorch\"), .product(name: \"backend_xnnpack\", package: \"executorch\"), .product(name: \"kernels_optimized\", package: \"executorch\"), // Add other backends and kernels as needed. ]), linkerSettings: [ // Force load all symbols from static libraries to trigger backends and kernels registration .unsafeFlags([\"-Wl,-all_load\"]) ] ] ) Then check if everything works correctly: cd path/to/your/package swift package resolve # or just build it swift build Building from Source# Another way to integrate the ExecuTorch runtime is to build the necessary components from sources locally and link against them. This is useful when customizing the runtime. Install Xcode 15+ and Command Line Tools: xcode-select --install Clone ExecuTorch: git clone -b viable/strict https://github.com/pytorch/executorch.git --depth 1 --recurse-submodules --shallow-submodules \u0026\u0026 cd executorch Set up Python 3.10+ and activate a virtual environment: python3 -m venv .venv \u0026\u0026 source .venv/bin/activate \u0026\u0026 pip install --upgrade pip Install the required dependencies, including those needed for the backends like Core ML or MPS, if you plan to build them later: ./install_requirements.sh # CoreML-only requirements: ./backends/apple/coreml/scripts/install_requirements.sh Install CMake: Download the macOS binary distribution from the CMake website, open the .dmg file, move CMake.app to the /Applications directory, and then run the following command to install the CMake command-line tools: sudo /Applications/CMake.app/Contents/bin/cmake-gui --install Use the provided script to build .xcframeworks: The following command will build the ExecuTorch runtime components along with all available kernels and backends for the Apple platform in both Release and Debug modes: ./scripts/build_apple_frameworks.sh After the build finishes successfully, the resulting frameworks can be found in the cmake-out directory. Copy them to your project and link them against your targets. Linkage# ExecuTorch initializes its backends and kernels (operators) during app startup by registering them in a static dictionary. If you encounter errors like \u201cunregistered kernel\u201d or \u201cunregistered backend\u201d at runtime, you may need to explicitly force-load certain components. Use the -all_load or -force_load linker flags in your Xcode build configuration to ensure components are registered early. Here\u2019s an example of a Xcode configuration file (.xcconfig): ET_PLATFORM[sdk=iphonesimulator*] = simulator ET_PLATFORM[sdk=iphoneos*] = ios ET_PLATFORM[sdk=macos*] = macos OTHER_LDFLAGS = $(inherited) \\ -force_load $(BUILT_PRODUCTS_DIR)/libexecutorch_debug_$(ET_PLATFORM).a \\ -force_load $(BUILT_PRODUCTS_DIR)/libbackend_coreml_$(ET_PLATFORM).a \\ -force_load $(BUILT_PRODUCTS_DIR)/libbackend_mps_$(ET_PLATFORM).a \\ -force_load $(BUILT_PRODUCTS_DIR)/libbackend_xnnpack_$(ET_PLATFORM).a \\ -force_load $(BUILT_PRODUCTS_DIR)/libkernels_optimized_$(ET_PLATFORM).a \\ -force_load $(BUILT_PRODUCTS_DIR)/libkernels_quantized_$(ET_PLATFORM).a Note: In the example above, we link against the Debug version of the ExecuTorch runtime (libexecutorch_debug) to preserve the logs. Normally, that does not impact the performance too much. Nevertheless, remember to link against the release version of the runtime (libexecutorch) for the best performance and no logs. You can assign such a config file to your target in Xcode: Add the .xcconfig file to your project. Navigate to the project\u2019s Info tab. Select the configuration file in the build configurations for Release (or Debug) mode. Runtime API# ExecuTorch provides native Objective-C APIs, automatically bridged to Swift, for interacting with the runtime. These APIs act as wrappers around the core C++ components found in extension/tensor and extension/module, offering a more idiomatic experience for Apple platform developers. Note: These Objective-C/Swift APIs are currently experimental and subject to change. Importing# Once linked against the executorch framework, you can import the necessary components. Objective-C (Objective-C++): // Import the main umbrella header for Module/Tensor/Value wrappers. #import \u003cExecuTorch/ExecuTorch.h\u003e // If using C++ directly alongside Objective-C++, you might still need C++ headers. #import \u003cexecutorch/extension/module/module.h\u003e #import \u003cexecutorch/extension/tensor/tensor.h\u003e Swift: import ExecuTorch Example# Here\u2019s a concise example demonstrating how to load a model, prepare input, run inference, and process output using the Objective-C and Swift API. Imagine you have a MobileNet v3 model (mv3.pte) that takes a [1, 3, 224, 224] float tensor as input and outputs logits. Objective-C: NSString *modelPath = [[NSBundle mainBundle] pathForResource:@\"mv3\" ofType:@\"pte\"]; // Create a module with the model file path. Nothing gets loaded into memory just yet. ExecuTorchModule *module = [[ExecuTorchModule alloc] initWithFilePath:modelPath]; NSError *error; // Optional error output argument to learn about failures. // Force-load the program and \u0027forward\u0027 method. Otherwise, it\u0027s loaded at the first execution. [module loadMethod:@\"forward\" error:\u0026error]; float *imageBuffer = ...; // Existing image buffer. // Create an input tensor referencing the buffer and assuming the given shape and data type. ExecuTorchTensor *inputTensor = [[ExecuTorchTensor alloc] initWithBytesNoCopy:imageBuffer shape:@[@1, @3, @224, @224] dataType:ExecuTorchDataTypeFloat]; // Execute the \u0027forward\u0027 method with the given input tensor and get output values back. NSArray\u003cExecuTorchValue *\u003e *outputs = [module forwardWithTensor:inputTensor error:\u0026error]; // Get the first output value assuming it\u0027s a tensor. ExecuTorchTensor *outputTensor = outputs.firstObject.tensorValue; // Access the output tensor data. [outputTensor bytesWithHandler:^(const void *pointer, NSInteger count, ExecuTorchDataType dataType) { float *logits = (float *)pointer; // Use logits... }]; Swift: let modelPath = Bundle.main.path(forResource: \"mv3\", ofType: \"pte\")! // Create a module with the model file path. Nothing gets loaded into memory just yet. let module = Module(filePath: modelPath) // Force-load the program and \u0027forward\u0027 method. Otherwise, it\u0027s loaded at the first execution. try module.load(\"forward\") let imageBuffer: UnsafeMutableRawPointer = ... // Existing image buffer // Create an input tensor referencing the buffer and assuming the given shape and data type. let inputTensor = Tensor\u003cFloat\u003e(\u0026imageBuffer, shape: [1, 3, 224, 224]) // Execute the \u0027forward\u0027 method with the given input tensor and get an output tensor back. let outputTensor = try Tensor\u003cFloat\u003e(module.forward(inputTensor)) // Copy the tensor data into logits array for easier access. let logits = outputTensor.scalars() // Use logits... Tensor# A tensor is a multi-dimensional array of elements (such as floats or integers) and includes metadata like shape (dimensions) and data type. Tensors are used to feed inputs to a model and retrieve outputs, or for any computation you need to do on raw data. You can create tensors from simple arrays of numbers, inspect their properties, read or modify their contents, and even reshape or copy them. ExecuTorch offers ExecuTorchTensor class in Objective-C and two tensor types in Swift: AnyTensor: A type-erased tensor, bridged from ExecuTorchTensor in Objective-C. You might use it when the tensor\u2019s data type is only known at runtime, for example, when converting from an untyped Value object before casting it to a generic Tensor\u003cT\u003e. Tensor\u003cT: Scalar\u003e: A generic, type-safe wrapper around AnyTensor. This is the recommended type for most use cases in Swift. It ensures the element type (e.g., Float, Int) is known at compile time, providing type-safe access to tensor data and catching type mismatches early. You can convert between them using tensor.anyTensor (to get the underlying AnyTensor) and anyTensor.asTensor() (to convert to a typed Tensor\u003cT\u003e if the data types match). Key Properties:# dataType: The element type (e.g., .float, .int, .byte). In Tensor\u003cT\u003e, this is determined by T. shape: An array of Int describing the size of each dimension. count: The total number of elements. strides: The jump in memory needed to advance one element along each dimension. dimensionOrder: The order of dimensions in memory. shapeDynamism: Indicates if the tensor shape can change (.static, .dynamicBound, .dynamicUnbound). Initialization:# You can create a new tensor from an existing one, either as a view (which shares the same underlying data) or as a copy (which gets its own unique data). View: init(_:) creates a new tensor instance that points to the same memory as the original. Modifying the data through one tensor will affect the other. Copy: copy() creates a completely independent duplicate of the tensor, including its own copy of the data. Objective-C: // Create a view. ExecuTorchTensor *tensorView = [[ExecuTorchTensor alloc] initWithTensor:originalTensor]; // Create a copy. ExecuTorchTensor *tensorCopy = [originalTensor copy]; Swift: // Create a view. let tensorView = Tensor(originalTensor) // Create a copy. let tensorCopy = originalTensor.copy() Tensors can be initialized directly from memory pointers or Data objects. init(bytesNoCopy:...): Creates a tensor that references an existing memory buffer without copying. The buffer\u2019s lifetime must be managed manually and must exceed the tensor\u2019s. init(bytes:...): Creates a tensor by copying data from a memory buffer. init(data:...): Creates a tensor using an NSData (Objective-C) or Data (Swift) object, referencing its bytes without copying. Objective-C: // Create by copying bytes. float data[] = {1.0f, 2.0f, 3.0f, 4.0f}; NSArray\u003cNSNumber *\u003e *shape = @[@2, @2]; ExecuTorchTensor *tensorFromBytes = [[ExecuTorchTensor alloc] initWithBytes:data shape:shape dataType:ExecuTorchDataTypeFloat]; // Create from NSData (no copy). NSData *nsData = [NSData dataWithBytes:data length:sizeof(data)]; ExecuTorchTensor *tensorFromNSData = [[ExecuTorchTensor alloc] initWithData:nsData shape:shape dataType:ExecuTorchDataTypeFloat]; Swift: // Create from a buffer without copying (unsafe). var mutableData: [Float] = [1.0, 2.0, 3.0, 4.0] let tensorNoCopy = mutableData.withUnsafeMutableBytes { pointer in Tensor\u003cFloat\u003e( bytesNoCopy: pointer.baseAddress!, shape: [2, 2] ) } // Create from Data (no copy). let data = Data(bytes: \u0026mutableData, count: mutableData.count * MemoryLayout\u003cFloat\u003e.size) let tensorFromData = Tensor\u003cFloat\u003e(data: data, shape: [2, 2]) The most convenient way to create tensors is from Swift arrays or single scalar values. The Tensor\u003cT\u003e API uses type inference to determine the dataType automatically. objective-c: // Create from an array of scalars. NSArray\u003cNSNumber *\u003e *scalars = @[@(1), @(2), @(3)]; NSArray\u003cNSNumber *\u003e *shape = @[@3]; ExecuTorchTensor *tensorFromScalars = [[ExecuTorchTensor alloc] initWithScalars:scalars shape:shape dataType:ExecuTorchDataTypeInt]; // Create a float scalar tensor. ExecuTorchTensor *scalarTensor = [[ExecuTorchTensor alloc] initWithFloat:3.14f]; Swift: // Create from an array of scalars (infers shape and copies data). let tensor = Tensor([1.0, 2.0, 3.0, 4.0]) // Creates a Tensor\u003cDouble\u003e with shape [4] // Specify shape. let tensorWithShape = Tensor([1, 2, 3, 4, 5, 6], shape: [2, 3]) // Creates Tensor\u003cInt\u003e // Create without copying from an `inout` array. var liveData: [Int32] = [10, 20, 30] let tensorNoCopy = Tensor(\u0026liveData) // Modifying `liveData` affects `tensorNoCopy` // Create an Int scalar tensor. let scalarTensor = Tensor(42) // Infers Tensor\u003cInt\u003e with shape [] Factory Methods:# ExecuTorch provides a rich set of factory methods to create tensors with pre-filled or random data. empty: Creates a tensor with uninitialized data. full: Creates a tensor filled with a specified scalar value. ones: Creates a tensor filled with ones. zeros: Creates a tensor filled with zeros. rand: Creates a tensor with random values uniformly distributed in [0, 1). randn: Creates a tensor with random values from a normal distribution (mean 0, variance 1). randint: Creates a tensor with random integers in a specified range [low, high). Each method has a like: variant that creates a new tensor with the same shape and properties as an existing one. Objective-C: // Create a 2x2 tensor filled with zeros. ExecuTorchTensor *zeros = [ExecuTorchTensor zerosTensorWithShape:@[@2, @2] dataType:ExecuTorchDataTypeFloat]; // Create a tensor of ones with the same shape as `zeros`. ExecuTorchTensor *ones = [ExecuTorchTensor onesTensorLikeTensor:zeros]; Swift: // Create a 2x2 tensor filled with the value 7. let fullTensor = Tensor\u003cInt32\u003e.full(shape: [2, 2], scalar: 7) // Create a 3x3 tensor of ones. let onesTensor = Tensor\u003cFloat\u003e.ones(shape: [3, 3]) // Create a tensor of zeros with the same shape as onesTensor. let zerosTensor = Tensor\u003cFloat\u003e.zeros(like: onesTensor) // Create a tensor with random integers between 10 (inclusive) and 20 (exclusive). let randomInts = Tensor\u003cInt\u003e.randint(low: 10, high: 20, shape: [5]) // Create a 2x2 type-erased tensor filled with zeros and explicit data type. let anyZeros = AnyTensor.zeros(shape: [2, 2], dataType: .float) // Create a 2x3 type-erased tensor filled with random values and explicit data type. let anyRand = AnyTensor.rand(shape: [2, 3], dataType: .double) Accessing Data:# Reading data: scalars(): Returns a copy of the tensor\u2019s elements as a new [T] array. withUnsafeBytes(_:): Provides a type-safe, immutable buffer pointer (UnsafeBufferPointer\u003cT\u003e) for efficient, direct memory access without creating a new array. bytesWithHandler:: The Objective-C and AnyTensor approach, which uses a callback with a raw void * pointer and requires manual type casting. Objective-C: [tensor bytesWithHandler:^(const void *pointer, NSInteger count, ExecuTorchDataType dataType) { if (dataType == ExecuTorchDataTypeFloat) { const float *floatPointer = (const float *)pointer; NSLog(@\"First float element: %f\", floatPointer[0]); } }]; Swift: let tensor = Tensor\u003cFloat\u003e([1.0, 2.0, 3.0, 4.0], shape: [2, 2]) // Get data copy as a Swift array. let scalars = tensor.scalars() print(\"All scalars: \\(scalars)\") // [1.0, 2.0, 3.0, 4.0] // Access data via a buffer pointer. tensor.withUnsafeBytes { buffer in print(\"First float element: \\(buffer.first ?? 0.0)\") } anyTensor.bytes { pointer, count, dataType in // Must check data type and manually cast the pointer for type-erased tensor. if dataType == .float { let buffer = UnsafeBufferPointer(start: pointer.assumingMemoryBound(to: Float.self), count: count) print(\"First float element from AnyTensor: \\(buffer.first ?? 0.0)\") } } Modifying Data: withUnsafeMutableBytes(_:): The preferred Swift method. Provides a type-safe, mutable buffer pointer (UnsafeMutableBufferPointer\u003cT\u003e) for in-place modification. mutableBytesWithHandler:: The Objective-C and AnyTensor equivalent. Objective-C: [tensor mutableBytesWithHandler:^(void *pointer, NSInteger count, ExecuTorchDataType dataType) { if (dataType == ExecuTorchDataTypeFloat) { float *floatPointer = (float *)pointer; floatPointer[0] = 100.0f; // Modify the tensor\u0027s data. } }]; Swift: let tensor = Tensor\u003cFloat\u003e([1.0, 2.0, 3.0, 4.0], shape: [2, 2]) // Modify the tensor\u0027s data in place. tensor.withUnsafeMutableBytes { buffer in buffer[1] = 200.0 } // tensor\u0027s data is now [1.0, 200.0, 3.0, 4.0] anyTensor.mutableBytes { pointer, count, dataType in if dataType == .float { let buffer = UnsafeMutableBufferPointer(start: pointer.assumingMemoryBound(to: Float.self), count: count) buffer[0] = 100.0 // Modify the AnyTensor\u0027s data } } Resizing:# Tensors can be resized if their shape dynamism is not .static. Resizing only changes the tensor\u2019s metadata (shape and strides) and does not reallocate or change the underlying data, so the new shape must have the same total number of elements. Objective-C: NSError *error; BOOL success = [tensor resizeToShape:@[@4, @1] error:\u0026error]; if (success) { NSLog(@\"Resized shape: %@\", tensor.shape); } else { NSLog(@\"Resize failed: %@\", error); } Swift: do { try tensor.resize(to: [4, 1]) print(\"Resized shape: \\(tensor.shape)\") } catch { print(\"Resize failed: \\(error)\") } Equality:# You can check if two tensors are equal using the == operator. It compares their data type, shape, strides, dimension order, and all underlying element data. The shapeDynamism property is disregarded in this comparison. Printing:# Tensors conform to CustomStringConvertible in Swift and implement -description in Objective-C, so you can print them directly to the console for easy debugging. Value# The Value class (exposed as ExecuTorchValue in Objective-C) is a dynamic container that can hold different types of data, primarily used for model inputs and outputs. ExecuTorch methods accept and return arrays of Value objects. Key Properties:# tag: Indicates the type of data held (e.g., .tensor, .integer, .string, .boolean). isTensor, isInteger, isString, etc.: Boolean checks for the type. tensor, integer, string, boolean, double: Accessors for the underlying data (return nil or a default value if the tag doesn\u2019t match). Initialization:# Create Value objects directly from the data they should hold. Objective-C: #import \u003cExecuTorch/ExecuTorch.h\u003e ExecuTorchTensor *tensor = [[ExecuTorchTensor alloc] initWithFloat:1.0f]; ExecuTorchValue *tensorValue = [[ExecuTorchValue alloc] valueWithTensor:tensor]; ExecuTorchValue *intValue = [[ExecuTorchValue alloc] valueWithInteger:100]; ExecuTorchValue *stringValue = [[ExecuTorchValue alloc] valueWithString:@\"hello\"]; ExecuTorchValue *boolValue = [[ExecuTorchValue alloc] valueWithBoolean:YES]; ExecuTorchValue *doubleValue = [[ExecuTorchValue alloc] valueWithDouble:3.14]; Swift: import ExecuTorch let tensor = Tensor(2.0) let tensorValue = Value(tensor) let intValue = Value(200) let stringValue = Value(\"world\") let boolValue = Value(false) let doubleValue = Value(2.718) Also, in Swift, all the types that Value can hold conform to the ValueConvertible protocol, so you can create Value objects directly from them without explicitly wrapping them in Value constructors: func processValue(_ value: ValueConvertible) { // ... } processValue(1) // Value\u003cInt\u003e processValue(1.0) // Value\u003cDouble\u003e processValue(\"hello\") // Value\u003cString\u003e processValue(true) // Value\u003cBool\u003e processValue(Tensor(1.0)) // Value\u003cTensor\u003e Module# The Module class (exposed as ExecuTorchModule in Objective-C) represents a loaded ExecuTorch model (.pte file). It provides methods to load the model program, inspect its methods, and execute them for inference. Note: Module and its methods are not thread-safe. If you need to do concurrent inferences from multiple threads, create one Module per thread. Initialization:# Create a Module instance by providing the file path to the .pte model. Initialization itself is lightweight and doesn\u2019t load the program data immediately. You can also specify a ModuleLoadMode to control how the file is loaded, such as using memory mapping for efficiency. Objective-C: #import \u003cExecuTorch/ExecuTorch.h\u003e NSString *modelPath = [[NSBundle mainBundle] pathForResource:@\"model\" ofType:@\"pte\"]; ExecuTorchModule *module = [[ExecuTorchModule alloc] initWithFilePath:modelPath]; // Optional: specify load mode, e.g., memory mapping. ExecuTorchModule *moduleMmap = [[ExecuTorchModule alloc] initWithFilePath:modelPath loadMode:ExecuTorchModuleLoadModeMmap]; Swift: import ExecuTorch let modelPath = Bundle.main.path(forResource: \"model\", ofType: \"pte\")! let module = Module(filePath: modelPath) // Optional: specify load mode, e.g., memory mapping. let moduleMmap = Module(filePath: modelPath, loadMode: .mmap) Loading:# Model loading is deferred until explicitly requested or needed. You can load the entire program or individual methods. While execution calls can trigger loading automatically, it\u2019s often more efficient to load methods explicitly beforehand. load(): Loads the basic program structure. You can specify a ModuleVerification level, though minimal verification is used by default. load(_:): Loads the program structure and prepares a specific method (e.g., \u201cforward\u201d) for execution. This performs necessary setup like backend delegation and is recommended if you know which method you\u2019ll run. isLoaded() / isLoaded(_:): Check loading status. Objective-C: NSError *error; // Loads program and prepares \u0027forward\u0027 for execution. BOOL success = [module loadMethod:@\"forward\" error:\u0026error]; if (success) { NSLog(@\"Forward method loaded: %d\", [module isMethodLoaded:@\"forward\"]); } else { NSLog(@\"Failed to load method: %@\", error); } Swift: do { // Loads program and prepares \u0027forward\u0027 for execution. try module.load(\"forward\") print(\"Forward method loaded: \\(module.isLoaded(\"forward\"))\") } catch { print(\"Failed to load method: \\(error)\") } Inspecting Method Metadata# You can programmatically inspect a method\u2019s contract\u2014its input/output types, tensor shapes, data types, and more\u2014by retrieving its MethodMetadata. This is incredibly useful for building dynamic applications that can adapt to different models without hardcoding dimensions. Objective-c: NSError *error; ExecuTorchMethodMetadata *metadata = [module methodMetadata:@\"forward\" error:\u0026error]; if (metadata) { // Check if the first input is a tensor. ExecuTorchValueTag firstInputTag = [metadata.inputValueTags[0] unsignedIntValue]; if (firstInputTag == ExecuTorchValueTagTensor) { // Get the metadata for the first input tensor. ExecuTorchTensorMetadata *tensorMeta = metadata.inputTensorMetadata[@0]; if (tensorMeta) { NSLog(@\"Expected input shape: %@\", tensorMeta.shape); NSLog(@\"Expected input data type: %ld\", (long)tensorMeta.dataType); // You can now dynamically create a matching input tensor. } } } Swift: do { // Easily inspect the \"forward\" method at runtime. let metadata = try module.methodMetadata(\"forward\") // Check if the first input is a tensor and get its metadata. if metadata.inputValueTags.first == .tensor, let tensorMeta = metadata.inputTensorMetadata[0] { print(\"Expected input shape: \\(tensorMeta.shape)\") print(\"Expected input data type: \\(tensorMeta.dataType)\") // Dynamically create a random tensor that matches the model\u0027s input specs. let input = AnyTensor.rand(shape: tensorMeta.shape, dataType: tensorMeta.dataType) // Use the dynamically created tensor for inference. let outputs = try module.forward(input) print(\"Successfully ran inference with dynamic input.\") } } catch { print(\"Failed to get metadata or run inference: \\(error)\") } Execution:# The Module class offers flexible ways to execute methods. Inputs can be any type conforming to ValueConvertible (like Tensor, Int, Float, Bool, etc.). execute(_:_:): Execute any available method by name with one or more inputs. forward(_:): A convenient shortcut for executing the common \u201cforward\u201d method. The API provides overloads for single inputs, multiple inputs, or no inputs. Outputs are returned in two ways: As an array of Values, letting you inspect and cast results yourself. As your expected type. The generic overloads decode the result directly into your desired Swift type (such as a single Tensor\u003cFloat\u003e, an array, or any custom type conforming to the ValueSequenceConstructible protocol). If the output doesn\u2019t match the expected type (e.g. multiple Values returned when a single object is expected, or a tensor data type mismatch), an invalid type error is thrown. Objective-C: ExecuTorchTensor *inputTensor1 = [[ExecuTorchTensor alloc] initWithScalars:@[@1.0f, @2.0f]]; ExecuTorchTensor *inputTensor2 = [[ExecuTorchTensor alloc] initWithScalars:@[@3.0f, @4.0f]]; ExecuTorchTensor *singleInputTensor = [[ExecuTorchTensor alloc] initWithFloat:5.0f]; NSError *error; // Execute \"forward\" using the shortcut with an array of Tensors. NSArray\u003cExecuTorchValue *\u003e *outputs1 = [module forwardWithTensors:@[inputTensor1, inputTensor2] error:\u0026error]; if (outputs1) { NSLog(@\"Forward output count: %lu\", (unsigned long)outputs1.count); } else { NSLog(@\"Execution failed: %@\", error); } // Execute \"forward\" with a single Tensor input. NSArray\u003cExecuTorchValue *\u003e *outputs2 = [module forwardWithTensor:singleInputTensor error:\u0026error]; if (outputs2) { NSLog(@\"Forward single input output count: %lu\", (unsigned long)outputs2.count); } else { NSLog(@\"Execution failed: %@\", error); } // Execute a potentially different method by name. NSArray\u003cExecuTorchValue *\u003e *outputs3 = [module executeMethod:@\"another_method\" withInput:[[ExecuTorchValue alloc] valueWithTensor:inputTensor1] error:\u0026error]; // Process outputs (assuming first output is a tensor). if (outputs1) { ExecuTorchValue *firstOutput = outputs1.firstObject; if (firstOutput.isTensor) { ExecuTorchTensor *resultTensor = firstOutput.tensorValue; // Process resultTensor. } } Swift: let inputTensor1 = Tensor\u003cFloat\u003e([1.0, 2.0]) let inputTensor2 = Tensor\u003cFloat\u003e([3.0, 4.0]) let singleInputTensor = Tensor\u003cFloat\u003e([5.0]) do { // Execute \"forward\" using the shortcut with an array of Tensors. let outputs1 = try module.forward([inputTensor1, inputTensor2]) print(\"Forward output count: \\(outputs1.count)\") // Execute \"forward\" with a single Tensor input. let outputs2 = try module.forward(singleInputTensor) print(\"Forward single input output count: \\(outputs2.count)\") // Execute a potentially different method by name. let outputs3 = try module.execute(\"another_method\", [inputTensor1]) // Process outputs by converting the first output Value to a typed Tensor\u003cFloat\u003e. if let outputTensor: Tensor\u003cFloat\u003e = outputs1.first?.tensor() { // Now you have a type-safe tensor and can access its data easily. let logits = try outputTensor.scalars() print(\"First 5 logits: \\(logits.prefix(5))\") } // Try casting the outputs to a single typed object. let tensorOutput = try Tensor\u003cFloat\u003e(module.forward(inputTensor1, inputTensor2)) let logits = tensorOutput.scalars() } catch { print(\"Execution failed: \\(error)\") } Method Names:# You can query the available method names in the model after the program is loaded. Objective-C: NSError *error; // Note: methodNames: will load the program if not already loaded. NSSet\u003cNSString *\u003e *names = [module methodNames:\u0026error]; if (names) { NSLog(@\"Available methods: %@\", names); } else { NSLog(@\"Could not get method names: %@\", error); } Swift: do { // Note: methodNames() will load the program if not already loaded. let names = try module.methodNames() print(\"Available methods: \\(names)\") // Output: e.g., {\"forward\"} } catch { print(\"Could not get method names: \\(error)\") } Logging# ExecuTorch provides APIs for logging in Objective-C and Swift via the ExecuTorchLog (Log in Swift) singleton. You can subscribe custom log sinks conforming to the ExecuTorchLogSink (LogSink in Swift) protocol to receive internal ExecuTorch log messages. Note: Logs are stripped in the Release builds of ExecuTorch frameworks. To capture logs, link against the Debug builds (e.g., executorch_debug) during development. Objective-C: #import \u003cExecuTorch/ExecuTorch.h\u003e #import \u003cos/log.h\u003e @interface MyClass : NSObject\u003cExecuTorchLogSink\u003e @end @implementation MyClass - (instancetype)init { self = [super init]; if (self) { #if DEBUG [ExecuTorchLog.sharedLog addSink:self]; #endif } return self; } - (void)dealloc { #if DEBUG [ExecuTorchLog.sharedLog removeSink:self]; #endif } #if DEBUG - (void)logWithLevel:(ExecuTorchLogLevel)level timestamp:(NSTimeInterval)timestamp filename:(NSString *)filename line:(NSUInteger)line message:(NSString *)message { NSString *logMessage = [NSString stringWithFormat:@\"%@:%lu %@\", filename, (unsigned long)line, message]; switch (level) { case ExecuTorchLogLevelDebug: os_log_with_type(OS_LOG_DEFAULT, OS_LOG_TYPE_DEBUG, \"%{public}@\", logMessage); break; case ExecuTorchLogLevelInfo: os_log_with_type(OS_LOG_DEFAULT, OS_LOG_TYPE_INFO, \"%{public}@\", logMessage); break; case ExecuTorchLogLevelError: os_log_with_type(OS_LOG_DEFAULT, OS_LOG_TYPE_ERROR, \"%{public}@\", logMessage); break; case ExecuTorchLogLevelFatal: os_log_with_type(OS_LOG_DEFAULT, OS_LOG_TYPE_FAULT, \"%{public}@\", logMessage); break; default: os_log(OS_LOG_DEFAULT, \"%{public}@\", logMessage); break; } } #endif @end Swift: import ExecuTorch import os.log public class MyClass { public init() { #if DEBUG Log.shared.add(sink: self) #endif } deinit { #if DEBUG Log.shared.remove(sink: self) #endif } } #if DEBUG extension MyClass: LogSink { public func log(level: LogLevel, timestamp: TimeInterval, filename: String, line: UInt, message: String) { let logMessage = \"\\(filename):\\(line) \\(message)\" switch level { case .debug: os_log(.debug, \"%{public}@\", logMessage) case .info: os_log(.info, \"%{public}@\", logMessage) case .error: os_log(.error, \"%{public}@\", logMessage) case .fatal: os_log(.fault, \"%{public}@\", logMessage) default: os_log(\"%{public}@\", logMessage) } } } #endif Note: In the example, the logs are intentionally stripped out when the code is not built for Debug mode, i.e., the DEBUG macro is not defined or equals zero. Debugging# If you are linking against a Debug build of the ExecuTorch frameworks, configure your debugger to map the source code correctly by using the following LLDB command in the debug session: settings append target.source-map /executorch \u003cpath_to_executorch_source_code\u003e Troubleshooting# Slow execution# Ensure the exported model is using an appropriate backend, such as XNNPACK, Core ML, or MPS. If the correct backend is invoked but performance issues persist, confirm that you are linking against the Release build of the backend runtime. For optimal performance, link the ExecuTorch runtime in Release mode too. If debugging is needed, you can keep the ExecuTorch runtime in Debug mode with minimal impact on performance, but preserve logging and debug symbols. Swift PM# If you encounter a checksum mismatch error with Swift PM, clear the package cache using the Xcode menu (File \u003e Packages \u003e Reset Package Caches) or the following command: rm -rf \u003cYouProjectName\u003e.xcodeproj/project.xcworkspace/xcshareddata/swiftpm \\ ~/Library/org.swift.swiftpm \\ ~/Library/Caches/org.swift.swiftpm \\ ~/Library/Caches/com.apple.dt.Xcode \\ ~/Library/Developer/Xcode/DerivedData Note: Ensure Xcode is fully quit before running the terminal command to avoid conflicts with active processes.",
       "author": {
         "@type": "Organization",
         "name": "PyTorch Contributors",
         "url": "https://pytorch.org"
       },
       "image": "https://pytorch.org/docs/stable/_static/img/pytorch_seo.png",
       "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "/using-executorch-ios.html"
       },
       "datePublished": "2023-01-01T00:00:00Z",
       "dateModified": "2023-01-01T00:00:00Z"
     }
 </script>
  <script>
    // Tutorials Call to action event tracking
    $("[data-behavior='call-to-action-event']").on('click', function () {
      fbq('trackCustom', "Download", {
        tutorialTitle: $('h1:first').text(),
        downloadLink: this.href,
        tutorialLink: window.location.href,
        downloadTitle: $(this).attr("data-response")
      });
      if (typeof gtag === 'function') {
        gtag('event', 'click', {
          'event_category': $(this).attr("data-response"),
          'event_label': $("h1").first().text(),
          'tutorial_link': window.location.href
        });
      }
    });
  </script>
  
  </body>
</html>