/*
 * Copyright (c) 2025 by Cadence Design Systems, Inc.  ALL RIGHTS RESERVED.
 * These coded instructions, statements, and computer programs are the
 * copyrighted works and confidential proprietary information of
 * Cadence Design Systems Inc.  They may be adapted and modified by bona fide
 * purchasers for internal use, but neither the original nor any adapted
 * or modified version may be disclosed or distributed to third parties
 * in any manner, medium, or form, in whole or in part, without the prior
 * written consent of Cadence Design Systems Inc.  This software and its
 * derivatives are to be executed solely on products incorporating a Cadence
 * Design Systems processor.
 */

#include "xai_cnn_common.h"

#ifndef IVP_UNPKU2NX8U_L
#define IVP_UNPKU2NX8U_L(vecIn)  xb_vecNx16_rtor_xb_vecNx16U(IVP_MOVNX16_FROM2NX8U(IVP_SEL2NX8UI(0, vecIn, IVP_SELI_8B_INTERLEAVE_1_LO)))
#endif

#ifndef IVP_UNPKU2NX8_L
#define IVP_UNPKU2NX8_L(vecIn)  IVP_MOVNX16_FROM2NX8U(IVP_SEL2NX8UI(0, vecIn, IVP_SELI_8B_INTERLEAVE_1_LO))
#endif

#ifndef IVP_UNPKS2NX8_L
#define IVP_UNPKS2NX8_L(vecIn)  IVP_MOVNX16_FROM2NX8(IVP_SEL2NX8I(IVP_SRAI2NX8(vecIn, 7), vecIn, IVP_SELI_8B_INTERLEAVE_1_LO))
#endif

#ifndef IVP_UNPKUNX16U_L
#define IVP_UNPKUNX16U_L(vecIn)  IVP_MOVN_2X32U_FROMNX16(IVP_SELNX16UI(0, vecIn, IVP_SELI_16B_INTERLEAVE_1_LO))
#endif

#ifndef IVP_UNPKSNX16_L
#define IVP_UNPKSNX16_L(vecIn)  IVP_MOVN_2X32_FROMNX16(IVP_SELNX16I(IVP_SRAINX16(vecIn, 15), vecIn, IVP_SELI_16B_INTERLEAVE_1_LO))
#endif

#define UNPKSNX8_L(vecIn)   IVP_MOVNX16_FROMN_2X32(IVP_SELN_2X32I(IVP_SRAIN_2X32(IVP_UNPKSNX16_L(IVP_UNPKS2NX8_L(vecIn)), 31), IVP_UNPKSNX16_L(IVP_UNPKS2NX8_L(vecIn)), IVP_SELI_32B_INTERLEAVE_1_LO))
#define UNPKSNX16_L(vecIn)  IVP_MOVNX16_FROMN_2X32(IVP_SELN_2X32I(IVP_SRAIN_2X32(IVP_UNPKSNX16_L(vecIn), 31), IVP_UNPKSNX16_L(vecIn), IVP_SELI_32B_INTERLEAVE_1_LO))
#define UNPKSNX32_L(vecIn)  IVP_MOVNX16_FROMN_2X32(IVP_SELN_2X32I(IVP_SRAIN_2X32(vecIn, 31), vecIn, IVP_SELI_32B_INTERLEAVE_1_LO))

#if IN_DATA_TYPE == UNSIGNED8BIT
#undef MORPH_IDT_SCALAR
#undef MORPH_IDT_VECTOR
#undef MORPH_IP_PRIME
#undef MORPH_IP_VAR_LOAD

#define MORPH_IDT_SCALAR   uint8_t
#define MORPH_IDT_VECTOR   xb_vec2Nx8U
#define MORPH_IP_PRIME     IVP_LA2NX8U_PP
#define MORPH_IP_VAR_LOAD  IVP_LAV2NX8U_XP

#if OUT_DATA_TYPE == SIGNED8BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU8ToS8
#define MORPH_VECTORIZATIONWIDTH  2 * XCHAL_IVPN_SIMD_WIDTH
#define MORPH_ODT_SCALAR          int8_t
#define MORPH_ODT_VECTOR          xb_vec2Nx8
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vec2Nx8U_rtor_xb_vec2Nx8(vecIn);
#define MORPH_OP_VAR_STORE        IVP_SAV2NX8_XP
#define MORPH_OP_FLUSH            IVP_SAPOS2NX8_FP

#elif OUT_DATA_TYPE == UNSIGNED16BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU8ToU16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH
#define MORPH_ODT_SCALAR          uint16_t
#define MORPH_ODT_VECTOR          xb_vecNx16U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_UNPKU2NX8U_L(vecIn)
#define MORPH_OP_VAR_STORE        IVP_SAVNX16U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNX16U_FP

#elif OUT_DATA_TYPE == SIGNED16BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU8ToS16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH
#define MORPH_ODT_SCALAR          int16_t
#define MORPH_ODT_VECTOR          xb_vecNx16
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_UNPKU2NX8_L(vecIn)
#define MORPH_OP_VAR_STORE        IVP_SAVNX16_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNX16_FP

#elif OUT_DATA_TYPE == UNSIGNED32BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU8ToU32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          uint32_t
#define MORPH_ODT_VECTOR          xb_vecN_2x32Uv
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_UNPKUNX16U_L(IVP_UNPKU2NX8U_L(vecIn))
#define MORPH_OP_VAR_STORE        IVP_SAVN_2X32U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2X32U_FP

#elif OUT_DATA_TYPE == SIGNED32BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU8ToS32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          int32_t
#define MORPH_ODT_VECTOR          xb_vecN_2x32v
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_UNPKUNX16U_L(IVP_UNPKU2NX8U_L(vecIn))
#define MORPH_OP_VAR_STORE        IVP_SAVN_2X32_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2X32_FP

#elif OUT_DATA_TYPE == UNSIGNED64BIT
#ifdef IVP_LAVN_4X64U_XP
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU8ToU64
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          uint64_t
#define MORPH_ODT_VECTOR          xb_vecN_4x64U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_MOVN_4X64U_FROMNX16(IVP_MOVNX16_FROM2NX8U(IVP_SEL2NX8UI(0, IVP_SEL2NX8UI(0, IVP_SEL2NX8UI(0, vecIn, IVP_SELI_8B_INTERLEAVE_1_LO), IVP_SELI_8B_INTERLEAVE_1_LO), IVP_SELI_8B_INTERLEAVE_1_LO)));
#define MORPH_OP_VAR_STORE        IVP_SAVN_4X64U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_4X64U_FP
#endif //#ifdef IVP_LAVN_4X64U_XP

#elif OUT_DATA_TYPE == SIGNED64BIT
#ifdef IVP_LAVN_4X64U_XP
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU8ToS64
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          int64_t
#define MORPH_ODT_VECTOR          xb_vecN_4x64
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_MOVN_4X64_FROMNX16(IVP_MOVNX16_FROM2NX8U(IVP_SEL2NX8UI(0, IVP_SEL2NX8UI(0, IVP_SEL2NX8UI(0, vecIn, IVP_SELI_8B_INTERLEAVE_1_LO), IVP_SELI_8B_INTERLEAVE_1_LO), IVP_SELI_8B_INTERLEAVE_1_LO)));
#define MORPH_OP_VAR_STORE        IVP_SAVN_4X64_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_4X64_FP
#endif //#ifdef IVP_LAVN_4X64U_XP

#elif OUT_DATA_TYPE == FLOAT16BIT
#if ((XCHAL_HAVE_VISION_HP_VFPU == 1) || (XCHAL_HAVE_BBENEP_HP_VFPU == 1))
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU8ToF16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          xb_f16
#define MORPH_ODT_VECTOR          xb_vecNxf16
#define MORPH_IDT_CAST(vecIn, vecOut)                                               \
  xb_vecN_2x32Uv temp = IVP_UNPKUNX16U_L(IVP_UNPKU2NX8U_L(vecIn));                  \
  xb_vecNxf16 temp1 = IVP_CVTF16N_2XF32_0(xb_vecN_2x32Uv_rtor_xb_vecN_2xf32(temp)); \
  vecOut = IVP_SELNXF16I(0, temp1, IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNXF16_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNXF16_FP
#endif

#elif OUT_DATA_TYPE == FLOAT32BIT
#if ((XCHAL_HAVE_VISION_SP_VFPU == 1) || (XCHAL_HAVE_BBENEP_SP_VFPU == 1))
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU8ToF32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          float
#define MORPH_ODT_VECTOR          xb_vecN_2xf32
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecN_2x32Uv_rtor_xb_vecN_2xf32(IVP_UNPKUNX16U_L(IVP_UNPKU2NX8U_L(vecIn)));
#define MORPH_OP_VAR_STORE        IVP_SAVN_2XF32_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2XF32_FP
#endif
#endif


#elif IN_DATA_TYPE == SIGNED8BIT
#undef MORPH_IDT_SCALAR
#undef MORPH_IDT_VECTOR
#undef MORPH_IP_PRIME
#undef MORPH_IP_VAR_LOAD

#define MORPH_IDT_SCALAR   int8_t
#define MORPH_IDT_VECTOR   xb_vec2Nx8
#define MORPH_IP_PRIME     IVP_LA2NX8_PP
#define MORPH_IP_VAR_LOAD  IVP_LAV2NX8_XP

#if OUT_DATA_TYPE == UNSIGNED8BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS8ToU8
#define MORPH_VECTORIZATIONWIDTH  2 * XCHAL_IVPN_SIMD_WIDTH
#define MORPH_ODT_SCALAR          uint8_t
#define MORPH_ODT_VECTOR          xb_vec2Nx8U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vec2Nx8_rtor_xb_vec2Nx8U(vecIn);
#define MORPH_OP_VAR_STORE        IVP_SAV2NX8U_XP
#define MORPH_OP_FLUSH            IVP_SAPOS2NX8U_FP

#elif OUT_DATA_TYPE == UNSIGNED16BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS8ToU16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH
#define MORPH_ODT_SCALAR          uint16_t
#define MORPH_ODT_VECTOR          xb_vecNx16U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecNx16_rtor_xb_vecNx16U(IVP_UNPKS2NX8_L(vecIn));
#define MORPH_OP_VAR_STORE        IVP_SAVNX16U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNX16U_FP

#elif OUT_DATA_TYPE == SIGNED16BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS8ToS16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH
#define MORPH_ODT_SCALAR          int16_t
#define MORPH_ODT_VECTOR          xb_vecNx16
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_UNPKS2NX8_L(vecIn);
#define MORPH_OP_VAR_STORE        IVP_SAVNX16_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNX16_FP

#elif OUT_DATA_TYPE == UNSIGNED32BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS8ToU32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          uint32_t
#define MORPH_ODT_VECTOR          xb_vecN_2x32Uv
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecN_2x32v_rtor_xb_vecN_2x32Uv(IVP_UNPKSNX16_L((IVP_UNPKS2NX8_L(vecIn))));
#define MORPH_OP_VAR_STORE        IVP_SAVN_2X32U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2X32U_FP

#elif OUT_DATA_TYPE == SIGNED32BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS8ToS32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          int32_t
#define MORPH_ODT_VECTOR          xb_vecN_2x32v
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_UNPKSNX16_L((IVP_UNPKS2NX8_L(vecIn)));
#define MORPH_OP_VAR_STORE        IVP_SAVN_2X32_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2X32_FP

#elif OUT_DATA_TYPE == UNSIGNED64BIT
#ifdef IVP_LAVN_4X64U_XP
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS8ToU64
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          uint64_t
#define MORPH_ODT_VECTOR          xb_vecN_4x64U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_MOVN_4X64U_FROMNX16(UNPKSNX8_L(vecIn));
#define MORPH_OP_VAR_STORE        IVP_SAVN_4X64U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_4X64U_FP
#endif //#ifdef IVP_LAVN_4X64U_XP

#elif OUT_DATA_TYPE == SIGNED64BIT
#ifdef IVP_LAVN_4X64U_XP
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS8ToS64
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          int64_t
#define MORPH_ODT_VECTOR          xb_vecN_4x64
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_MOVN_4X64_FROMNX16(UNPKSNX8_L(vecIn));
#define MORPH_OP_VAR_STORE        IVP_SAVN_4X64_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_4X64_FP
#endif //#ifdef IVP_LAVN_4X64U_XP

#elif OUT_DATA_TYPE == FLOAT16BIT
#if ((XCHAL_HAVE_VISION_HP_VFPU == 1) || (XCHAL_HAVE_BBENEP_HP_VFPU == 1))
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS8ToF16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          xb_f16
#define MORPH_ODT_VECTOR          xb_vecNxf16
#define MORPH_IDT_CAST(vecIn, vecOut)                                              \
  xb_vecN_2x32v temp = IVP_UNPKSNX16_L(IVP_UNPKS2NX8_L(vecIn));                    \
  xb_vecNxf16 temp1 = IVP_CVTF16N_2XF32_0(xb_vecN_2x32v_rtor_xb_vecN_2xf32(temp)); \
  vecOut = IVP_SELNXF16I(0, temp1, IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNXF16_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNXF16_FP
#endif

#elif OUT_DATA_TYPE == FLOAT32BIT
#if ((XCHAL_HAVE_VISION_SP_VFPU == 1) || (XCHAL_HAVE_BBENEP_SP_VFPU == 1))
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS8ToF32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          float
#define MORPH_ODT_VECTOR          xb_vecN_2xf32
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecN_2x32v_rtor_xb_vecN_2xf32(IVP_UNPKSNX16_L(IVP_UNPKS2NX8_L(vecIn)));
#define MORPH_OP_VAR_STORE        IVP_SAVN_2XF32_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2XF32_FP
#endif
#endif


#elif IN_DATA_TYPE == UNSIGNED16BIT
#undef MORPH_IDT_SCALAR
#undef MORPH_IDT_VECTOR
#undef MORPH_IP_PRIME
#undef MORPH_IP_VAR_LOAD

#define MORPH_IDT_SCALAR   uint16_t
#define MORPH_IDT_VECTOR   xb_vecNx16U
#define MORPH_IP_PRIME     IVP_LANX16U_PP
#define MORPH_IP_VAR_LOAD  IVP_LAVNX16U_XP

#if OUT_DATA_TYPE == UNSIGNED8BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU16ToU8
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH
#define MORPH_ODT_SCALAR          uint8_t
#define MORPH_ODT_VECTOR          xb_vec2Nx8U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_MOV2NX8U_FROMNX16(IVP_SELNX16UI(0, vecIn, IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0));
#define MORPH_OP_VAR_STORE        IVP_SAV2NX8U_XP
#define MORPH_OP_FLUSH            IVP_SAPOS2NX8U_FP

#elif OUT_DATA_TYPE == SIGNED8BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU16ToS8
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH
#define MORPH_ODT_SCALAR          int8_t
#define MORPH_ODT_VECTOR          xb_vec2Nx8
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_MOV2NX8_FROMNX16(IVP_SELNX16UI(0, vecIn, IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0));
#define MORPH_OP_VAR_STORE        IVP_SAV2NX8_XP
#define MORPH_OP_FLUSH            IVP_SAPOS2NX8_FP

#elif OUT_DATA_TYPE == SIGNED16BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU16ToS16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH
#define MORPH_ODT_SCALAR          int16_t
#define MORPH_ODT_VECTOR          xb_vecNx16
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecNx16U_rtor_xb_vecNx16(vecIn);
#define MORPH_OP_VAR_STORE        IVP_SAVNX16_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNX16_FP

#elif OUT_DATA_TYPE == UNSIGNED32BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU16ToU32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          uint32_t
#define MORPH_ODT_VECTOR          xb_vecN_2x32Uv
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_UNPKUNX16U_L(vecIn);
#define MORPH_OP_VAR_STORE        IVP_SAVN_2X32U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2X32U_FP

#elif OUT_DATA_TYPE == SIGNED32BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU16ToS32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          int32_t
#define MORPH_ODT_VECTOR          xb_vecN_2x32v
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecN_2x32Uv_rtor_xb_vecN_2x32v(IVP_UNPKUNX16U_L(vecIn));
#define MORPH_OP_VAR_STORE        IVP_SAVN_2X32_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2X32_FP

#elif OUT_DATA_TYPE == UNSIGNED64BIT
#ifdef IVP_LAVN_4X64U_XP
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU16ToU64
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          uint64_t
#define MORPH_ODT_VECTOR          xb_vecN_4x64U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_MOVN_4X64U_FROMNX16(IVP_SELNX16UI(0, IVP_SELNX16UI(0, vecIn, IVP_SELI_16B_INTERLEAVE_1_LO), IVP_SELI_16B_INTERLEAVE_1_LO));
#define MORPH_OP_VAR_STORE        IVP_SAVN_4X64U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_4X64U_FP
#endif //#ifdef IVP_LAVN_4X64U_XP

#elif OUT_DATA_TYPE == SIGNED64BIT
#ifdef IVP_LAVN_4X64U_XP
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU16ToS64
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          int64_t
#define MORPH_ODT_VECTOR          xb_vecN_4x64
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_MOVN_4X64_FROMNX16(IVP_SELNX16UI(0, IVP_SELNX16UI(0, vecIn, IVP_SELI_16B_INTERLEAVE_1_LO), IVP_SELI_16B_INTERLEAVE_1_LO));
#define MORPH_OP_VAR_STORE        IVP_SAVN_4X64_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_4X64_FP
#endif //#ifdef IVP_LAVN_4X64U_XP

#elif OUT_DATA_TYPE == FLOAT16BIT
#if ((XCHAL_HAVE_VISION_HP_VFPU == 1) || (XCHAL_HAVE_BBENEP_HP_VFPU == 1))
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU16ToF16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          xb_f16
#define MORPH_ODT_VECTOR          xb_vecNxf16
#define MORPH_IDT_CAST(vecIn, vecOut)                                                                 \
  xb_vecNxf16 temp = IVP_CVTF16N_2XF32_0(xb_vecN_2x32Uv_rtor_xb_vecN_2xf32(IVP_UNPKUNX16U_L(vecIn))); \
  vecOut           = IVP_SELNXF16I(0, temp, IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNXF16_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNXF16_FP
#endif

#elif OUT_DATA_TYPE == FLOAT32BIT
#if ((XCHAL_HAVE_VISION_SP_VFPU == 1) || (XCHAL_HAVE_BBENEP_SP_VFPU == 1))
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU16ToF32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          float
#define MORPH_ODT_VECTOR          xb_vecN_2xf32
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecN_2x32Uv_rtor_xb_vecN_2xf32(IVP_UNPKUNX16U_L(vecIn));
#define MORPH_OP_VAR_STORE        IVP_SAVN_2XF32_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2XF32_FP
#endif
#endif


#elif IN_DATA_TYPE == SIGNED16BIT
#undef MORPH_IDT_SCALAR
#undef MORPH_IDT_VECTOR
#undef MORPH_IP_PRIME
#undef MORPH_IP_VAR_LOAD

#define MORPH_IDT_SCALAR   int16_t
#define MORPH_IDT_VECTOR   xb_vecNx16
#define MORPH_IP_PRIME     IVP_LANX16_PP
#define MORPH_IP_VAR_LOAD  IVP_LAVNX16_XP

#if OUT_DATA_TYPE == UNSIGNED8BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS16ToU8
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH
#define MORPH_ODT_SCALAR          uint8_t
#define MORPH_ODT_VECTOR          xb_vec2Nx8U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_MOV2NX8U_FROMNX16(IVP_SELNX16I(0, vecIn, IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0));
#define MORPH_OP_VAR_STORE        IVP_SAV2NX8U_XP
#define MORPH_OP_FLUSH            IVP_SAPOS2NX8U_FP

#elif OUT_DATA_TYPE == SIGNED8BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS16ToS8
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH
#define MORPH_ODT_SCALAR          int8_t
#define MORPH_ODT_VECTOR          xb_vec2Nx8
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_MOV2NX8_FROMNX16(IVP_SELNX16I(0, vecIn, IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0));
#define MORPH_OP_VAR_STORE        IVP_SAV2NX8_XP
#define MORPH_OP_FLUSH            IVP_SAPOS2NX8_FP

#elif OUT_DATA_TYPE == UNSIGNED16BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS16ToU16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH
#define MORPH_ODT_SCALAR          uint16_t
#define MORPH_ODT_VECTOR          xb_vecNx16U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecNx16_rtor_xb_vecNx16U(vecIn);
#define MORPH_OP_VAR_STORE        IVP_SAVNX16U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNX16U_FP

#elif OUT_DATA_TYPE == UNSIGNED32BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS16ToU32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          uint32_t
#define MORPH_ODT_VECTOR          xb_vecN_2x32Uv
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecN_2x32v_rtor_xb_vecN_2x32Uv(IVP_UNPKSNX16_L(vecIn));
#define MORPH_OP_VAR_STORE        IVP_SAVN_2X32U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2X32U_FP

#elif OUT_DATA_TYPE == SIGNED32BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS16ToS32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          int32_t
#define MORPH_ODT_VECTOR          xb_vecN_2x32v
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_UNPKSNX16_L(vecIn);
#define MORPH_OP_VAR_STORE        IVP_SAVN_2X32_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2X32_FP

#elif OUT_DATA_TYPE == UNSIGNED64BIT
#ifdef IVP_LAVN_4X64U_XP
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS16ToU64
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          uint64_t
#define MORPH_ODT_VECTOR          xb_vecN_4x64U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_MOVN_4X64U_FROMNX16(UNPKSNX16_L(vecIn));
#define MORPH_OP_VAR_STORE        IVP_SAVN_4X64U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_4X64U_FP
#endif //#ifdef IVP_LAVN_4X64U_XP

#elif OUT_DATA_TYPE == SIGNED64BIT
#ifdef IVP_LAVN_4X64U_XP
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS16ToS64
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          int64_t
#define MORPH_ODT_VECTOR          xb_vecN_4x64
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_MOVN_4X64_FROMNX16(UNPKSNX16_L(vecIn));
#define MORPH_OP_VAR_STORE        IVP_SAVN_4X64_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_4X64_FP
#endif //#ifdef IVP_LAVN_4X64U_XP

#elif OUT_DATA_TYPE == FLOAT16BIT
#if ((XCHAL_HAVE_VISION_HP_VFPU == 1) || (XCHAL_HAVE_BBENEP_HP_VFPU == 1))
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS16ToF16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          xb_f16
#define MORPH_ODT_VECTOR          xb_vecNxf16
#define MORPH_IDT_CAST(vecIn, vecOut)                                                               \
  xb_vecNxf16 temp = IVP_CVTF16N_2XF32_0(xb_vecN_2x32v_rtor_xb_vecN_2xf32(IVP_UNPKSNX16_L(vecIn))); \
  vecOut           = IVP_SELNXF16I(0, temp, IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNXF16_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNXF16_FP
#endif

#elif OUT_DATA_TYPE == FLOAT32BIT
#if ((XCHAL_HAVE_VISION_SP_VFPU == 1) || (XCHAL_HAVE_BBENEP_SP_VFPU == 1))
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS16ToF32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          float
#define MORPH_ODT_VECTOR          xb_vecN_2xf32
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecN_2x32v_rtor_xb_vecN_2xf32(IVP_UNPKSNX16_L(vecIn));
#define MORPH_OP_VAR_STORE        IVP_SAVN_2XF32_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2XF32_FP
#endif
#endif


#elif IN_DATA_TYPE == UNSIGNED32BIT
#undef MORPH_IDT_SCALAR
#undef MORPH_IDT_VECTOR
#undef MORPH_IP_PRIME
#undef MORPH_IP_VAR_LOAD

#define MORPH_IDT_SCALAR   uint32_t
#define MORPH_IDT_VECTOR   xb_vecN_2x32Uv
#define MORPH_IP_PRIME     IVP_LAN_2X32U_PP
#define MORPH_IP_VAR_LOAD  IVP_LAVN_2X32U_XP

#if OUT_DATA_TYPE == UNSIGNED8BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU32ToU8
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          uint8_t
#define MORPH_ODT_VECTOR          xb_vec2Nx8U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SEL2NX8UI(0, IVP_SEL2NX8UI(0, IVP_MOV2NX8U_FROMNX16(IVP_MOVNX16_FROMN_2X32U(vecIn)), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0);
#define MORPH_OP_VAR_STORE        IVP_SAV2NX8U_XP
#define MORPH_OP_FLUSH            IVP_SAPOS2NX8U_FP

#elif OUT_DATA_TYPE == SIGNED8BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU32ToS8
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          int8_t
#define MORPH_ODT_VECTOR          xb_vec2Nx8
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SEL2NX8I(0, IVP_SEL2NX8I(0, IVP_MOV2NX8_FROMNX16(IVP_MOVNX16_FROMN_2X32U(vecIn)), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0);
#define MORPH_OP_VAR_STORE        IVP_SAV2NX8_XP
#define MORPH_OP_FLUSH            IVP_SAPOS2NX8_FP

#elif OUT_DATA_TYPE == UNSIGNED16BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU32ToU16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          uint16_t
#define MORPH_ODT_VECTOR          xb_vecNx16U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SELNX16UI(0, IVP_MOVNX16_FROMN_2X32U(vecIn), IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNX16U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNX16U_FP

#elif OUT_DATA_TYPE == SIGNED16BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU32ToS16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          int16_t
#define MORPH_ODT_VECTOR          xb_vecNx16
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SELNX16I(0, IVP_MOVNX16_FROMN_2X32U(vecIn), IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNX16_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNX16_FP

#elif OUT_DATA_TYPE == SIGNED32BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU32ToS32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          int32_t
#define MORPH_ODT_VECTOR          xb_vecN_2x32v
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecN_2x32Uv_rtor_xb_vecN_2x32v(vecIn);
#define MORPH_OP_VAR_STORE        IVP_SAVN_2X32_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2X32_FP

#elif OUT_DATA_TYPE == UNSIGNED64BIT
#ifdef IVP_LAVN_4X64U_XP
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU32ToU64
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          uint64_t
#define MORPH_ODT_VECTOR          xb_vecN_4x64U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_MOVN_4X64U_FROMNX16(IVP_MOVNX16_FROMN_2X32U(IVP_SELN_2X32UI(0, vecIn, IVP_SELI_32B_INTERLEAVE_1_LO)));
#define MORPH_OP_VAR_STORE        IVP_SAVN_4X64U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_4X64U_FP
#endif //#ifdef IVP_LAVN_4X64U_XP

#elif OUT_DATA_TYPE == SIGNED64BIT
#ifdef IVP_LAVN_4X64U_XP
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU32ToS64
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          int64_t
#define MORPH_ODT_VECTOR          xb_vecN_4x64
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_MOVN_4X64_FROMNX16(IVP_MOVNX16_FROMN_2X32(IVP_SELN_2X32I(0, vecIn, IVP_SELI_32B_INTERLEAVE_1_LO)));
#define MORPH_OP_VAR_STORE        IVP_SAVN_4X64_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_4X64_FP
#endif //#ifdef IVP_LAVN_4X64U_XP

#elif OUT_DATA_TYPE == FLOAT16BIT
#if ((XCHAL_HAVE_VISION_HP_VFPU == 1) || (XCHAL_HAVE_BBENEP_HP_VFPU == 1))
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU32ToF16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          xb_f16
#define MORPH_ODT_VECTOR          xb_vecNxf16
#define MORPH_IDT_CAST(vecIn, vecOut)                                               \
  xb_vecNxf16 temp = IVP_CVTF16N_2XF32_0(xb_vecN_2x32Uv_rtor_xb_vecN_2xf32(vecIn)); \
  vecOut           = IVP_SELNXF16I(0, temp, IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNXF16_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNXF16_FP
#endif

#elif OUT_DATA_TYPE == FLOAT32BIT
#if ((XCHAL_HAVE_VISION_SP_VFPU == 1) || (XCHAL_HAVE_BBENEP_SP_VFPU == 1))
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU32ToF32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          float
#define MORPH_ODT_VECTOR          xb_vecN_2xf32
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecN_2x32Uv_rtor_xb_vecN_2xf32(vecIn);
#define MORPH_OP_VAR_STORE        IVP_SAVN_2XF32_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2XF32_FP
#endif
#endif


#elif IN_DATA_TYPE == SIGNED32BIT
#undef MORPH_IDT_SCALAR
#undef MORPH_IDT_VECTOR
#undef MORPH_IP_PRIME
#undef MORPH_IP_VAR_LOAD

#define MORPH_IDT_SCALAR   int32_t
#define MORPH_IDT_VECTOR   xb_vecN_2x32v
#define MORPH_IP_PRIME     IVP_LAN_2X32_PP
#define MORPH_IP_VAR_LOAD  IVP_LAVN_2X32_XP

#if OUT_DATA_TYPE == UNSIGNED8BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS32ToU8
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          uint8_t
#define MORPH_ODT_VECTOR          xb_vec2Nx8U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SEL2NX8UI(0, IVP_SEL2NX8UI(0, IVP_MOV2NX8U_FROMNX16(IVP_MOVNX16_FROMN_2X32(vecIn)), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0);
#define MORPH_OP_VAR_STORE        IVP_SAV2NX8U_XP
#define MORPH_OP_FLUSH            IVP_SAPOS2NX8U_FP

#elif OUT_DATA_TYPE == SIGNED8BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS32ToS8
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          int8_t
#define MORPH_ODT_VECTOR          xb_vec2Nx8
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SEL2NX8I(0, IVP_SEL2NX8I(0, IVP_MOV2NX8_FROMNX16(IVP_MOVNX16_FROMN_2X32(vecIn)), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0);
#define MORPH_OP_VAR_STORE        IVP_SAV2NX8_XP
#define MORPH_OP_FLUSH            IVP_SAPOS2NX8_FP

#elif OUT_DATA_TYPE == UNSIGNED16BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS32ToU16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          uint16_t
#define MORPH_ODT_VECTOR          xb_vecNx16U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SELNX16UI(0, IVP_MOVNX16_FROMN_2X32(vecIn), IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNX16U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNX16U_FP

#elif OUT_DATA_TYPE == SIGNED16BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS32ToS16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          int16_t
#define MORPH_ODT_VECTOR          xb_vecNx16
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SELNX16I(0, IVP_MOVNX16_FROMN_2X32(vecIn), IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNX16_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNX16_FP

#elif OUT_DATA_TYPE == UNSIGNED32BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS32ToU32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          uint32_t
#define MORPH_ODT_VECTOR          xb_vecN_2x32Uv
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecN_2x32v_rtor_xb_vecN_2x32Uv(vecIn);
#define MORPH_OP_VAR_STORE        IVP_SAVN_2X32U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2X32U_FP

#elif OUT_DATA_TYPE == UNSIGNED64BIT
#ifdef IVP_LAVN_4X64U_XP
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS32ToU64
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          uint64_t
#define MORPH_ODT_VECTOR          xb_vecN_4x64U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_MOVN_4X64U_FROMNX16(UNPKSNX32_L(vecIn));
#define MORPH_OP_VAR_STORE        IVP_SAVN_4X64U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_4X64U_FP
#endif //#ifdef IVP_LAVN_4X64U_XP

#elif OUT_DATA_TYPE == SIGNED64BIT
#ifdef IVP_LAVN_4X64U_XP
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS32ToS64
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          int64_t
#define MORPH_ODT_VECTOR          xb_vecN_4x64
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_MOVN_4X64_FROMNX16(UNPKSNX32_L(vecIn));
#define MORPH_OP_VAR_STORE        IVP_SAVN_4X64_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_4X64_FP
#endif //#ifdef IVP_LAVN_4X64U_XP

#elif OUT_DATA_TYPE == FLOAT16BIT
#if ((XCHAL_HAVE_VISION_HP_VFPU == 1) || (XCHAL_HAVE_BBENEP_HP_VFPU == 1))
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS32ToF16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          xb_f16
#define MORPH_ODT_VECTOR          xb_vecNxf16
#define MORPH_IDT_CAST(vecIn, vecOut)                                              \
  xb_vecNxf16 temp = IVP_CVTF16N_2XF32_0(xb_vecN_2x32v_rtor_xb_vecN_2xf32(vecIn)); \
  vecOut           = IVP_SELNXF16I(0, temp, IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNXF16_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNXF16_FP
#endif

#elif OUT_DATA_TYPE == FLOAT32BIT
#if ((XCHAL_HAVE_VISION_SP_VFPU == 1) || (XCHAL_HAVE_BBENEP_SP_VFPU == 1))
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS32ToF32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          float
#define MORPH_ODT_VECTOR          xb_vecN_2xf32
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecN_2x32v_rtor_xb_vecN_2xf32(vecIn);
#define MORPH_OP_VAR_STORE        IVP_SAVN_2XF32_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2XF32_FP
#endif
#endif


#elif IN_DATA_TYPE == UNSIGNED64BIT
#ifdef IVP_LAVN_4X64U_XP
#undef MORPH_IDT_SCALAR
#undef MORPH_IDT_VECTOR
#undef MORPH_IP_PRIME
#undef MORPH_IP_VAR_LOAD

#define MORPH_IDT_SCALAR   uint64_t
#define MORPH_IDT_VECTOR   xb_vecN_4x64U
#define MORPH_IP_PRIME     IVP_LAN_4X64U_PP
#define MORPH_IP_VAR_LOAD  IVP_LAVN_4X64U_XP

#if OUT_DATA_TYPE == UNSIGNED8BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU64ToU8
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          uint8_t
#define MORPH_ODT_VECTOR          xb_vec2Nx8U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SEL2NX8UI(0, IVP_SEL2NX8UI(0, IVP_SEL2NX8UI(0, IVP_MOV2NX8U_FROMNX16(IVP_MOVNX16_FROMN_4X64U(vecIn)), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0);
#define MORPH_OP_VAR_STORE        IVP_SAV2NX8U_XP
#define MORPH_OP_FLUSH            IVP_SAPOS2NX8U_FP

#elif OUT_DATA_TYPE == SIGNED8BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU64ToS8
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          int8_t
#define MORPH_ODT_VECTOR          xb_vec2Nx8
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SEL2NX8I(0, IVP_SEL2NX8I(0, IVP_SEL2NX8I(0, IVP_MOV2NX8_FROMNX16(IVP_MOVNX16_FROMN_4X64U(vecIn)), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0);
#define MORPH_OP_VAR_STORE        IVP_SAV2NX8_XP
#define MORPH_OP_FLUSH            IVP_SAPOS2NX8_FP

#elif OUT_DATA_TYPE == UNSIGNED16BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU64ToU16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          uint16_t
#define MORPH_ODT_VECTOR          xb_vecNx16U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SELNX16UI(0, IVP_SELNX16UI(0, IVP_MOVNX16_FROMN_4X64U(vecIn), IVP_SELI_16B_DEINTERLEAVE_1_EVEN), IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNX16U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNX16U_FP

#elif OUT_DATA_TYPE == SIGNED16BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU64ToS16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          int16_t
#define MORPH_ODT_VECTOR          xb_vecNx16
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SELNX16I(0, IVP_SELNX16I(0, IVP_MOVNX16_FROMN_4X64U(vecIn), IVP_SELI_16B_DEINTERLEAVE_1_EVEN), IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNX16_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNX16_FP

#elif OUT_DATA_TYPE == UNSIGNED32BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU64ToU32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          uint32_t
#define MORPH_ODT_VECTOR          xb_vecN_2x32Uv
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SELN_2X32UI(0, IVP_MOVN_2X32U_FROMNX16(IVP_MOVNX16_FROMN_4X64U(vecIn)), IVP_SELI_32B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVN_2X32U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2X32U_FP

#elif OUT_DATA_TYPE == SIGNED32BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU64ToS32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          int32_t
#define MORPH_ODT_VECTOR          xb_vecN_2x32v
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SELN_2X32I(0, IVP_MOVN_2X32_FROMNX16(IVP_MOVNX16_FROMN_4X64U(vecIn)), IVP_SELI_32B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVN_2X32_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2X32_FP

#elif OUT_DATA_TYPE == SIGNED64BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU64ToS64
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          int64_t
#define MORPH_ODT_VECTOR          xb_vecN_4x64
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecN_4x64U_rtor_xb_vecN_4x64(vecIn);
#define MORPH_OP_VAR_STORE        IVP_SAVN_4X64_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_4X64_FP

#elif OUT_DATA_TYPE == FLOAT16BIT
#if ((XCHAL_HAVE_VISION_HP_VFPU == 1) || (XCHAL_HAVE_BBENEP_HP_VFPU == 1))
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU64ToF16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          xb_f16
#define MORPH_ODT_VECTOR          xb_vecNxf16
#define MORPH_IDT_CAST(vecIn, vecOut)                                                                                                                  \
  xb_vecNxf16 temp = IVP_CVTF16N_2XF32_0(IVP_SELN_2X32I(0, IVP_MOVN_2X32_FROMNX16(IVP_MOVNX16_FROMN_4X64U(vecIn)), IVP_SELI_32B_DEINTERLEAVE_1_EVEN)); \
  vecOut           = IVP_SELNXF16I(0, temp, IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNXF16_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNXF16_FP
#endif

#elif OUT_DATA_TYPE == FLOAT32BIT
#if ((XCHAL_HAVE_VISION_SP_VFPU == 1) || (XCHAL_HAVE_BBENEP_SP_VFPU == 1))
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromU64ToF32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          float
#define MORPH_ODT_VECTOR          xb_vecN_2xf32
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecN_2x32v_rtor_xb_vecN_2xf32(IVP_SELN_2X32I(0, IVP_MOVN_2X32_FROMNX16(IVP_MOVNX16_FROMN_4X64U(vecIn)), IVP_SELI_32B_DEINTERLEAVE_1_EVEN));
#define MORPH_OP_VAR_STORE        IVP_SAVN_2XF32_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2XF32_FP
#endif
#endif //#ifdef IVP_LAVN_4X64U_XP
#endif


#elif IN_DATA_TYPE == SIGNED64BIT
#ifdef IVP_LAVN_4X64U_XP
#undef MORPH_IDT_SCALAR
#undef MORPH_IDT_VECTOR
#undef MORPH_IP_PRIME
#undef MORPH_IP_VAR_LOAD

#define MORPH_IDT_SCALAR   int64_t
#define MORPH_IDT_VECTOR   xb_vecN_4x64
#define MORPH_IP_PRIME     IVP_LAN_4X64_PP
#define MORPH_IP_VAR_LOAD  IVP_LAVN_4X64_XP

#if OUT_DATA_TYPE == UNSIGNED8BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS64ToU8
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          uint8_t
#define MORPH_ODT_VECTOR          xb_vec2Nx8U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SEL2NX8UI(0, IVP_SEL2NX8UI(0, IVP_SEL2NX8UI(0, IVP_MOV2NX8U_FROMNX16(IVP_MOVNX16_FROMN_4X64(vecIn)), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0);
#define MORPH_OP_VAR_STORE        IVP_SAV2NX8U_XP
#define MORPH_OP_FLUSH            IVP_SAPOS2NX8U_FP

#elif OUT_DATA_TYPE == SIGNED8BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS64ToS8
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          int8_t
#define MORPH_ODT_VECTOR          xb_vec2Nx8
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SEL2NX8I(0, IVP_SEL2NX8I(0, IVP_SEL2NX8I(0, IVP_MOV2NX8_FROMNX16(IVP_MOVNX16_FROMN_4X64(vecIn)), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0);
#define MORPH_OP_VAR_STORE        IVP_SAV2NX8_XP
#define MORPH_OP_FLUSH            IVP_SAPOS2NX8_FP

#elif OUT_DATA_TYPE == UNSIGNED16BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS64ToU16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          uint16_t
#define MORPH_ODT_VECTOR          xb_vecNx16U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SELNX16UI(0, IVP_SELNX16UI(0, IVP_MOVNX16_FROMN_4X64(vecIn), IVP_SELI_16B_DEINTERLEAVE_1_EVEN), IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNX16U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNX16U_FP

#elif OUT_DATA_TYPE == SIGNED16BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS64ToS16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          int16_t
#define MORPH_ODT_VECTOR          xb_vecNx16
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SELNX16I(0, IVP_SELNX16I(0, IVP_MOVNX16_FROMN_4X64(vecIn), IVP_SELI_16B_DEINTERLEAVE_1_EVEN), IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNX16_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNX16_FP

#elif OUT_DATA_TYPE == UNSIGNED32BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS64ToU32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          uint32_t
#define MORPH_ODT_VECTOR          xb_vecN_2x32Uv
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SELN_2X32UI(0, IVP_MOVN_2X32U_FROMNX16(IVP_MOVNX16_FROMN_4X64(vecIn)), IVP_SELI_32B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVN_2X32U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2X32U_FP

#elif OUT_DATA_TYPE == SIGNED32BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS64ToS32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          int32_t
#define MORPH_ODT_VECTOR          xb_vecN_2x32v
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SELN_2X32I(0, IVP_MOVN_2X32_FROMNX16(IVP_MOVNX16_FROMN_4X64(vecIn)), IVP_SELI_32B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVN_2X32_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2X32_FP

#elif OUT_DATA_TYPE == UNSIGNED64BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS64ToU64
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          uint64_t
#define MORPH_ODT_VECTOR          xb_vecN_4x64U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecN_4x64_rtor_xb_vecN_4x64U(vecIn);
#define MORPH_OP_VAR_STORE        IVP_SAVN_4X64U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_4X64U_FP

#elif OUT_DATA_TYPE == FLOAT16BIT
#if ((XCHAL_HAVE_VISION_HP_VFPU == 1) || (XCHAL_HAVE_BBENEP_HP_VFPU == 1))
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS64ToF16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          xb_f16
#define MORPH_ODT_VECTOR          xb_vecNxf16
#define MORPH_IDT_CAST(vecIn, vecOut)                                                                                                                 \
  xb_vecNxf16 temp = IVP_CVTF16N_2XF32_0(IVP_SELN_2X32I(0, IVP_MOVN_2X32_FROMNX16(IVP_MOVNX16_FROMN_4X64(vecIn)), IVP_SELI_32B_DEINTERLEAVE_1_EVEN)); \
  vecOut           = IVP_SELNXF16I(0, temp, IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNXF16_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNXF16_FP
#endif

#elif OUT_DATA_TYPE == FLOAT32BIT
#if ((XCHAL_HAVE_VISION_SP_VFPU == 1) || (XCHAL_HAVE_BBENEP_SP_VFPU == 1))
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromS64ToF32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          float
#define MORPH_ODT_VECTOR          xb_vecN_2xf32
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecN_2x32v_rtor_xb_vecN_2xf32(IVP_SELN_2X32I(0, IVP_MOVN_2X32_FROMNX16(IVP_MOVNX16_FROMN_4X64(vecIn)), IVP_SELI_32B_DEINTERLEAVE_1_EVEN));
#define MORPH_OP_VAR_STORE        IVP_SAVN_2XF32_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2XF32_FP
#endif
#endif //#ifdef IVP_LAVN_4X64U_XP
#endif


#elif IN_DATA_TYPE == FLOAT16BIT
#if ((XCHAL_HAVE_VISION_HP_VFPU == 1) || (XCHAL_HAVE_BBENEP_HP_VFPU == 1))
#undef MORPH_IDT_SCALAR
#undef MORPH_IDT_VECTOR
#undef MORPH_IP_PRIME
#undef MORPH_IP_VAR_LOAD

#define MORPH_IDT_SCALAR   xb_f16
#define MORPH_IDT_VECTOR   xb_vecNxf16
#define MORPH_IP_PRIME     IVP_LANXF16_PP
#define MORPH_IP_VAR_LOAD  IVP_LAVNXF16_XP

#if OUT_DATA_TYPE == UNSIGNED8BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromF16ToU8
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          uint8_t
#define MORPH_ODT_VECTOR          xb_vec2Nx8U
#define MORPH_IDT_CAST(vecIn, vecOut)                                                            \
  xb_vecN_2xf32 temp = IVP_CVTF32NXF16_0(IVP_SELNXF16I(0, vecIn, IVP_SELI_16B_INTERLEAVE_1_LO)); \
  vecOut             = IVP_SEL2NX8UI(0, IVP_SEL2NX8UI(0, IVP_MOV2NX8U_FROMNX16(IVP_MOVNX16_FROMN_2X32(xb_vecN_2xf32_rtor_xb_vecN_2x32v(temp))), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0);
#define MORPH_OP_VAR_STORE        IVP_SAV2NX8U_XP
#define MORPH_OP_FLUSH            IVP_SAPOS2NX8U_FP

#elif OUT_DATA_TYPE == SIGNED8BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromF16ToS8
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          int8_t
#define MORPH_ODT_VECTOR          xb_vec2Nx8
#define MORPH_IDT_CAST(vecIn, vecOut)                                                            \
  xb_vecN_2xf32 temp = IVP_CVTF32NXF16_0(IVP_SELNXF16I(0, vecIn, IVP_SELI_16B_INTERLEAVE_1_LO)); \
  vecOut             = IVP_SEL2NX8I(0, IVP_SEL2NX8I(0, IVP_MOV2NX8_FROMNX16(IVP_MOVNX16_FROMN_2X32(xb_vecN_2xf32_rtor_xb_vecN_2x32v(temp))), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0);
#define MORPH_OP_VAR_STORE        IVP_SAV2NX8_XP
#define MORPH_OP_FLUSH            IVP_SAPOS2NX8_FP

#elif OUT_DATA_TYPE == UNSIGNED16BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromF16ToU16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          uint16_t
#define MORPH_ODT_VECTOR          xb_vecNx16U
#define MORPH_IDT_CAST(vecIn, vecOut)                                                            \
  xb_vecN_2xf32 temp = IVP_CVTF32NXF16_0(IVP_SELNXF16I(0, vecIn, IVP_SELI_16B_INTERLEAVE_1_LO)); \
  vecOut             = IVP_SELNX16UI(0, IVP_MOVNX16_FROMN_2X32(xb_vecN_2xf32_rtor_xb_vecN_2x32v(temp)), IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNX16U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNX16U_FP

#elif OUT_DATA_TYPE == SIGNED16BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromF16ToS16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          int16_t
#define MORPH_ODT_VECTOR          xb_vecNx16
#define MORPH_IDT_CAST(vecIn, vecOut)                                                            \
  xb_vecN_2xf32 temp = IVP_CVTF32NXF16_0(IVP_SELNXF16I(0, vecIn, IVP_SELI_16B_INTERLEAVE_1_LO)); \
  vecOut             = IVP_SELNX16I(0, IVP_MOVNX16_FROMN_2X32(xb_vecN_2xf32_rtor_xb_vecN_2x32v(temp)), IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNX16_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNX16_FP

#elif OUT_DATA_TYPE == UNSIGNED32BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromF16ToU32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          uint32_t
#define MORPH_ODT_VECTOR          xb_vecN_2x32Uv
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecN_2xf32_rtor_xb_vecN_2x32Uv(IVP_CVTF32NXF16_0(IVP_SELNXF16I(0, vecIn, IVP_SELI_16B_INTERLEAVE_1_LO)));
#define MORPH_OP_VAR_STORE        IVP_SAVN_2X32U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2X32U_FP

#elif OUT_DATA_TYPE == SIGNED32BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromF16ToS32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          int32_t
#define MORPH_ODT_VECTOR          xb_vecN_2x32v
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecN_2xf32_rtor_xb_vecN_2x32v(IVP_CVTF32NXF16_0(IVP_SELNXF16I(0, vecIn, IVP_SELI_16B_INTERLEAVE_1_LO)));
#define MORPH_OP_VAR_STORE        IVP_SAVN_2X32_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2X32_FP

#elif OUT_DATA_TYPE == UNSIGNED64BIT
#ifdef IVP_LAVN_4X64U_XP
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromF16ToU64
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          uint64_t
#define MORPH_ODT_VECTOR          xb_vecN_4x64U
#define MORPH_IDT_CAST(vecIn, vecOut)                                                                                                \
  xb_vecN_2x32v vecInp = xb_vecN_2xf32_rtor_xb_vecN_2x32v(IVP_CVTF32NXF16_0(IVP_SELNXF16I(0, vecIn, IVP_SELI_16B_INTERLEAVE_1_LO))); \
  xb_vecN_2x32v sign = IVP_SRAIN_2X32(vecInp, 31);                                                                                   \
  vecOut = IVP_MOVN_4X64U_FROMNX16(IVP_MOVNX16_FROMN_2X32(IVP_SELN_2X32UI(sign, vecInp, IVP_SELI_32B_INTERLEAVE_1_LO)));
#define MORPH_OP_VAR_STORE        IVP_SAVN_4X64U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_4X64U_FP
#endif //#ifdef IVP_LAVN_4X64U_XP

#elif OUT_DATA_TYPE == SIGNED64BIT
#ifdef IVP_LAVN_4X64U_XP
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromF16ToS64
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          int64_t
#define MORPH_ODT_VECTOR          xb_vecN_4x64
#define MORPH_IDT_CAST(vecIn, vecOut)                                                                                                \
  xb_vecN_2x32v vecInp = xb_vecN_2xf32_rtor_xb_vecN_2x32v(IVP_CVTF32NXF16_0(IVP_SELNXF16I(0, vecIn, IVP_SELI_16B_INTERLEAVE_1_LO))); \
  xb_vecN_2x32v sign = IVP_SRAIN_2X32(vecInp, 31);                                                                                   \
  vecOut = IVP_MOVN_4X64_FROMNX16(IVP_MOVNX16_FROMN_2X32(IVP_SELN_2X32UI(sign, vecInp, IVP_SELI_32B_INTERLEAVE_1_LO)));
#define MORPH_OP_VAR_STORE        IVP_SAVN_4X64_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_4X64_FP
#endif //#ifdef IVP_LAVN_4X64U_XP

#elif OUT_DATA_TYPE == FLOAT32BIT
#if ((XCHAL_HAVE_VISION_SP_VFPU == 1) || (XCHAL_HAVE_BBENEP_SP_VFPU == 1))
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromF16ToF32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          float
#define MORPH_ODT_VECTOR          xb_vecN_2xf32
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_CVTF32NXF16_0(IVP_SELNXF16I(0, vecIn, IVP_SELI_16B_INTERLEAVE_1_LO));
#define MORPH_OP_VAR_STORE        IVP_SAVN_2XF32_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2XF32_FP
#endif
#endif
#endif


#elif IN_DATA_TYPE == FLOAT32BIT
#if ((XCHAL_HAVE_VISION_SP_VFPU == 1) || (XCHAL_HAVE_BBENEP_SP_VFPU == 1))
#undef MORPH_IDT_SCALAR
#undef MORPH_IDT_VECTOR
#undef MORPH_IP_PRIME
#undef MORPH_IP_VAR_LOAD

#define MORPH_IDT_SCALAR   float
#define MORPH_IDT_VECTOR   xb_vecN_2xf32
#define MORPH_IP_PRIME     IVP_LAN_2XF32_PP
#define MORPH_IP_VAR_LOAD  IVP_LAVN_2XF32_XP

#if OUT_DATA_TYPE == UNSIGNED8BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromF32ToU8
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          uint8_t
#define MORPH_ODT_VECTOR          xb_vec2Nx8U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SEL2NX8UI(0, IVP_SEL2NX8UI(0, IVP_MOV2NX8U_FROMNX16(IVP_MOVNX16_FROMN_2X32(xb_vecN_2xf32_rtor_xb_vecN_2x32v(vecIn))), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0);
#define MORPH_OP_VAR_STORE        IVP_SAV2NX8U_XP
#define MORPH_OP_FLUSH            IVP_SAPOS2NX8U_FP

#elif OUT_DATA_TYPE == SIGNED8BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromF32ToS8
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          int8_t
#define MORPH_ODT_VECTOR          xb_vec2Nx8
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SEL2NX8I(0, IVP_SEL2NX8I(0, IVP_MOV2NX8_FROMNX16(IVP_MOVNX16_FROMN_2X32(xb_vecN_2xf32_rtor_xb_vecN_2x32v(vecIn))), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0), IVP_SELI_8B_EXTRACT_1_OF_2_OFF_0);
#define MORPH_OP_VAR_STORE        IVP_SAV2NX8_XP
#define MORPH_OP_FLUSH            IVP_SAPOS2NX8_FP

#elif OUT_DATA_TYPE == UNSIGNED16BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromF32ToU16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          uint16_t
#define MORPH_ODT_VECTOR          xb_vecNx16U
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SELNX16UI(0, IVP_MOVNX16_FROMN_2X32(xb_vecN_2xf32_rtor_xb_vecN_2x32v(vecIn)), IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNX16U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNX16U_FP

#elif OUT_DATA_TYPE == SIGNED16BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromF32ToS16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          int16_t
#define MORPH_ODT_VECTOR          xb_vecNx16
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = IVP_SELNX16I(0, IVP_MOVNX16_FROMN_2X32(xb_vecN_2xf32_rtor_xb_vecN_2x32v(vecIn)), IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNX16_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNX16_FP

#elif OUT_DATA_TYPE == UNSIGNED32BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromF32ToU32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          uint32_t
#define MORPH_ODT_VECTOR          xb_vecN_2x32Uv
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecN_2xf32_rtor_xb_vecN_2x32Uv(vecIn);
#define MORPH_OP_VAR_STORE        IVP_SAVN_2X32U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2X32U_FP

#elif OUT_DATA_TYPE == SIGNED32BIT
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromF32ToS32
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          int32_t
#define MORPH_ODT_VECTOR          xb_vecN_2x32v
#define MORPH_IDT_CAST(vecIn, vecOut)  vecOut = xb_vecN_2xf32_rtor_xb_vecN_2x32v(vecIn);
#define MORPH_OP_VAR_STORE        IVP_SAVN_2X32_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_2X32_FP

#elif OUT_DATA_TYPE == UNSIGNED64BIT
#ifdef IVP_LAVN_4X64U_XP
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromF32ToU64
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          uint64_t
#define MORPH_ODT_VECTOR          xb_vecN_4x64U
#define MORPH_IDT_CAST(vecIn, vecOut)                              \
  xb_vecN_2x32v vecInp = xb_vecN_2xf32_rtor_xb_vecN_2x32Uv(vecIn); \
  xb_vecN_2x32v sign = IVP_SRAIN_2X32(vecInp, 31);                 \
  vecOut = IVP_MOVN_4X64U_FROMNX16(IVP_MOVNX16_FROMN_2X32U(IVP_SELN_2X32UI(sign, vecInp, IVP_SELI_32B_INTERLEAVE_1_LO)));
#define MORPH_OP_VAR_STORE        IVP_SAVN_4X64U_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_4X64U_FP
#endif //#ifdef IVP_LAVN_4X64U_XP

#elif OUT_DATA_TYPE == SIGNED64BIT
#ifdef IVP_LAVN_4X64U_XP
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromF32ToS64
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 4
#define MORPH_ODT_SCALAR          int64_t
#define MORPH_ODT_VECTOR          xb_vecN_4x64
#define MORPH_IDT_CAST(vecIn, vecOut)                             \
  xb_vecN_2x32v vecInp = xb_vecN_2xf32_rtor_xb_vecN_2x32v(vecIn); \
  xb_vecN_2x32v sign = IVP_SRAIN_2X32(vecInp, 31);                \
  vecOut = IVP_MOVN_4X64_FROMNX16(IVP_MOVNX16_FROMN_2X32(IVP_SELN_2X32UI(sign, vecInp, IVP_SELI_32B_INTERLEAVE_1_LO)));
#define MORPH_OP_VAR_STORE        IVP_SAVN_4X64_XP
#define MORPH_OP_FLUSH            IVP_SAPOSN_4X64_FP
#endif //#ifdef IVP_LAVN_4X64U_XP

#elif OUT_DATA_TYPE == FLOAT16BIT
#if ((XCHAL_HAVE_VISION_HP_VFPU == 1) || (XCHAL_HAVE_BBENEP_HP_VFPU == 1))
#undef MAKE_NAME
#undef MORPH_VECTORIZATIONWIDTH
#undef MORPH_ODT_SCALAR
#undef MORPH_ODT_VECTOR
#undef MORPH_IDT_CAST
#undef MORPH_OP_VAR_STORE
#undef MORPH_OP_FLUSH

#define MAKE_NAME(name)  name ## FromF32ToF16
#define MORPH_VECTORIZATIONWIDTH  XCHAL_IVPN_SIMD_WIDTH / 2
#define MORPH_ODT_SCALAR          xb_f16
#define MORPH_ODT_VECTOR          xb_vecNxf16
#define MORPH_IDT_CAST(vecIn, vecOut)            \
  xb_vecNxf16 temp = IVP_CVTF16N_2XF32_0(vecIn); \
  vecOut           = IVP_SELNXF16I(0, temp, IVP_SELI_16B_DEINTERLEAVE_1_EVEN);
#define MORPH_OP_VAR_STORE        IVP_SAVNXF16_XP
#define MORPH_OP_FLUSH            IVP_SAPOSNXF16_FP
#endif
#endif
#endif
#endif

/**************************** xaiCast3D *****************************************/
/* Description  :  Data casting implementation for input and output data Type   */
/*               of S8, U8, S16, U16, S32, U32, U64, S64, F16 and F32           */
/* Inputs       : inTile                                                        */
/* Outputs      : void                                                          */
/* InOuts       : outTile                                                       */
/********************************************************************************/

void MAKE_NAME (xaiCast3D)(const xai_pTile3D inTile, xai_pTile3D outTile)
{
  /* Get Tile Parameters */
  const int32_t dim1Size  = XAI_TILE3D_GET_DIM1(inTile);
  const int32_t dim2Size  = XAI_TILE3D_GET_DIM2(inTile);
  const int32_t dim3Size  = XAI_TILE3D_GET_DIM3(inTile);
  const int32_t inPitch1  = XAI_TILE3D_GET_DIM1_PITCH(inTile);
  const int32_t inPitch2  = XAI_TILE3D_GET_DIM2_PITCH(inTile);
  const int32_t outPitch1 = XAI_TILE3D_GET_DIM1_PITCH(outTile);
  const int32_t outPitch2 = XAI_TILE3D_GET_DIM2_PITCH(outTile);

  MORPH_IDT_SCALAR* pInput  = (MORPH_IDT_SCALAR *) XAI_TILE3D_GET_DATA_PTR(inTile);
  MORPH_ODT_SCALAR* pOutput = (MORPH_ODT_SCALAR *) XAI_TILE3D_GET_DATA_PTR(outTile);

  MORPH_IDT_VECTOR *__restrict pdvecIn;
  MORPH_ODT_VECTOR *__restrict pdvecOut;

  valign vaOutData = IVP_ZALIGN();
  MORPH_IDT_VECTOR vecInData;
  MORPH_ODT_VECTOR vecOutData;

  if ((inPitch2 == (dim1Size * dim2Size)) && (outPitch2 == inPitch2))
  {
    int dimsCount = dim1Size * dim2Size * dim3Size;
    int x;
    pdvecIn  = (MORPH_IDT_VECTOR *) pInput;
    pdvecOut = (MORPH_ODT_VECTOR *) pOutput;
    valign vaInData = MORPH_IP_PRIME(pdvecIn);

    for (x = 0; x < dimsCount; x += MORPH_VECTORIZATIONWIDTH)
    {
      int remLen = MIN2(dimsCount - x, MORPH_VECTORIZATIONWIDTH);
      MORPH_IP_VAR_LOAD(vecInData, vaInData, pdvecIn, sizeof(MORPH_IDT_SCALAR) * remLen);
      MORPH_IDT_CAST(vecInData, vecOutData);
      MORPH_OP_VAR_STORE(vecOutData, vaOutData, pdvecOut, sizeof(MORPH_ODT_SCALAR) * remLen);
    }
    MORPH_OP_FLUSH(vaOutData, pdvecOut);
  }
  else
  {
    int x, y, z;
    for (z = 0; z < dim3Size; z++)
    {
      for (y = 0; y < dim2Size; y++)
      {
        MORPH_IDT_SCALAR* pIn  = pInput + z * inPitch2 + y * inPitch1;
        MORPH_ODT_SCALAR* pOut = pOutput + z * outPitch2 + y * outPitch1;

        pdvecIn  = (MORPH_IDT_VECTOR *) pIn;
        pdvecOut = (MORPH_ODT_VECTOR *) pOut;
        valign vaInData = MORPH_IP_PRIME(pdvecIn);

        for (x = 0; x < dim1Size; x += MORPH_VECTORIZATIONWIDTH)
        {
          int remLen = MIN2(dim1Size - x, MORPH_VECTORIZATIONWIDTH);
          MORPH_IP_VAR_LOAD(vecInData, vaInData, pdvecIn, sizeof(MORPH_IDT_SCALAR) * remLen);
          MORPH_IDT_CAST(vecInData, vecOutData);
          MORPH_OP_VAR_STORE(vecOutData, vaOutData, pdvecOut, sizeof(MORPH_ODT_SCALAR) * remLen);
        }
        MORPH_OP_FLUSH(vaOutData, pdvecOut);
      } // end of for(y = 0; y < dim2Size; y++)
    }   // end of for(z = 0; z < dim3Size; z++)
  }     // end of   if((inPitch2 == (dim1Size * dim2Size)) && (outPitch2 == inPitch2))

  return;
}

